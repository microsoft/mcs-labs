<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autonomous Agent with Computer-Using Agents | Microsoft Copilot Studio Labs</title>
    <link rel="stylesheet" href="/mcs-labs/assets/css/style.css">
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Autonomous Agent with Computer-Using Agents | Microsoft Copilot Studio Labs</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Autonomous Agent with Computer-Using Agents" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Autonomous Portfolio Lookup Agent with Computer-Using Agents (CUA) Build an autonomous Copilot Studio agent that retrieves financial portfolio data from internal legacy systems that lack API connectivity. 🧭 Lab Details Level Persona Duration Purpose 200 Maker/Developer 30 minutes After completing this lab, participants will be able to build an autonomous agent in Microsoft Copilot Studio that uses the Computer use tool to simulate human interaction with legacy systems and integrates Microsoft 365 Outlook to handle email-based data requests and responses. 📚 Table of Contents Why This Matters Introduction Core Concepts Overview Documentation and Additional Training Links Prerequisites Summary of Targets Use Cases Covered Instructions by Use Case Use Case #1: Create and Configure an Autonomous Agent Use Case #2: Add Computer Use and Email Connector 🤔 Why This Matters Legacy systems without APIs create major roadblocks for automation. Traditional RPA often relies on fragile screen-scraping or manual workarounds, which slow down decision-making, increase errors, and reduce productivity. This lab introduces Microsoft Copilot Studio and Computer Using Agents (CUA) as a smarter solution. By simulating human interaction with internal systems, CUAs can securely access and process data - without needing API integration. You’ll learn to build an autonomous agent that delivers faster responses, reduces manual workload, and enables real-time, informed decisions. 🌐 Introduction In this lab, you’ll learn how to build an autonomous agent using Microsoft Copilot Studio. This agent will simulate human interaction with a legacy internal system to retrieve financial portfolio data without requiring direct API access. Real-world example: A financial advisor needs quick access to key portfolio details - such as client name, portfolio value, and assigned manager - to prepare for meetings, review performance, resolve issues, or recommend rebalancing. However, this data resides in a legacy system that lacks an API and is restricted from direct access. Traditional RPA tools may fall short in such scenarios. They rely on fragile screen-scraping and require constant maintenance, making them unreliable and costly for dynamic, real-time use cases. As a result, advisors must depend on back-office teams to retrieve information, causing delays, inefficiencies, and a higher risk of errors - ultimately limiting their ability to make timely, informed decisions. By implementing a Copilot Studio agent, advisors can securely and instantly retrieve accurate portfolio data. This improves response times, reduces manual workload, and enhances overall productivity without the limitations of traditional RPA. 🎓 Core Concepts Overview Concept Why it matters Autonomous Agents Enable 24/7 automated responses to user inquiries, reducing manual workload and improving response times while maintaining consistency in support quality. Triggers Events, as simple as “Email received”, that trigger autonomous agents to then automatically detect and process the content and context initially provided. Tools Tools are simple or sophisticated connectors that the Copilot Studio orchestrator can invoke in response to user queries or business events. Computer use tool Enables the agent to interact with any system that has a graphical user interface. It works with websites and desktop apps by selecting buttons, choosing menus, and entering text into fields on the screen. It performs the task on a computer you set up using a virtual mouse and keyboard, enabling agents to complete tasks even when there isn’t an API to connect to the system directly. If a person can use an app or website, Computer use can too. Hosted browser The hosted browser runs in a Microsoft-managed environment and lets you get started with Computer use quickly without any machine setup. It provides both web automation using Microsoft Edge and access to built-in Windows applications. 📄 Documentation and Additional Training Links Microsoft Copilot Studio Documentation Copilot Studio Triggers Use connectors in Copilot Studio Office 365 Outlook Connector Automate web and desktop apps with computer use ✅ Prerequisites Access to Microsoft Copilot Studio with appropriate licensing Office 365 environment with Outlook integration enabled 🎯 Summary of Targets In this lab, you’ll build an autonomous portfolio lookup agent that retrieves portfolio information from an internal legacy system. By the end of the lab, you will: Create and configure an autonomous agent with email triggers for automatic activation Add a Computer use tool to simulate the process of a human user retrieving information from a website by logging into a computer, navigating through the website’s graphical user interface, performing searches, and extracting the required data Configure email response tools that reply professionally with proper formatting Test the complete workflow with realistic scenarios and various requests 🧩 Use Cases Covered Step Use Case Value added Effort 1 Create and Configure an Autonomous Agent Establishes the foundation for automated email processing with intelligent trigger configuration 10 min 2 Add Computer Use and Email Connector Enables automated data retrieval from a legacy internal system lacking API connectivity, without requiring backend access or system modifications, by implementing a non-intrusive integration layer. Delivers comprehensive, automated email responses containing only the specifically requested data. 10 min 🛠️ Instructions by Use Case 🔄 Use Case #1: Create and Configure an Autonomous Agent Set up the foundational autonomous agent with email triggers that automatically activates when email requests arrive. Use case Value added Estimated effort Create and Configure an Autonomous Agent Establishes the foundation for automated email processing with intelligent trigger configuration 5 min Summary of tasks You will create a new autonomous agent in Microsoft Copilot Studio, configure its identity, and set up an email trigger using the Microsoft 365 Outlook connector. Scenario: To automate portfolio lookups, the agent must be able to detect incoming email requests and initiate the appropriate automation flow based on subject line filtering. Objective Learn how to create and configure an autonomous agent that listens for specific email triggers and prepares to launch automation tasks in response. Step-by-step instructions Creating the agent and trigger setup Navigate to copilotstudio.microsoft.com Make sure you’re in the correct environment by looking at the top right corner. In these labs, the environment name should start with ‘DEV - ‘ Go to the Solutions menu (located in the left-hand menu under the ellipsis ...) Select the solution you had created previously for your labs Select New and choose Agent Select Configure to bypass the initial setup wizard Name your agent Portfolio Lookup Agent Select Create Configuring email triggers Scroll down to the triggers section and click +Add trigger Search and select When a new email arrives (V3) (Office 365 Outlook) Select Next Rename the trigger to When a portfolio lookup email arrives Select Next In the Subject Filter (Optional) field, enter Portfolio to filter emails that contain the word “Portfolio” in the subject line Finally Create trigger 🏅 Congratulations! You’ve completed Use Case #1! 🖥️ Use Case #2: Add Computer Use and Email Connector Configure a Computer use tool that logs into a computer, navigates through a website, searches and retrieves financial portfolio data. Then use the Office 365 Outlook connector to reply with the requested data. Use case Value added Estimated effort Add Computer Use and Email Connector Enables automated data retrieval from a legacy internal system lacking API connectivity, without requiring backend access or system modifications, by implementing a non-intrusive integration layer. Delivers comprehensive, automated email responses containing only the specifically requested data. 10 min Summary of tasks You will configure the Computer use tool to simulate GUI-based data retrieval, set up the Send an email tool for automated responses, and define the agent’s behavior and testing flow. Scenario: To complete the automation loop, the agent must retrieve portfolio data from a legacy web interface using desktop simulation and respond to email requests with accurate, formatted information. Objective Learn how to integrate and configure tools for desktop automation and email communication, define agent instructions, and test the full end-to-end workflow from trigger to response. Step-by-step instructions Configuring the Computer use tool Navigate to Tools in the top-level menu Select + Add a tool Select + New tool Select Computer use Add the following Instructions: 1. Go to https://computerusedemos.blob.core.windows.net/web/Portfolio/index.html. 2. Enter the Portfolio ID in the &quot;Enter Portfolio ID&quot; search field and click on the &quot;Search&quot; button. 3. Retrieve the &quot;Client Name&quot;, &quot;Portfolio Value&quot; and &quot;Manager&quot; values exactly as shown. 4. Return those three values as the final output. If no portfolio data is found, reply that you couldn&#39;t find a portfolio with the specified ID. Keep the box Use hosted browser checked to create a connection to the hosted browser Select Add and configure Update the Name of the Computer use tool as Look up portfolio data Update the Description as Search and retrieve financial portfolio data In the Inputs section select + Add input Enter name Portfolio ID and description The ID of the portfolio and select Done [!TIP] During execution, Computer use combines your instructions with the input values to complete the task. Select Save Testing the Computer use tool In the Instructions section, select the Test button on the right Add the sample value 44123BCD and select Test now Observe the Computer use tool logging into the computer and performing the requested actions: The left panel shows your instructions and a step-by-step log of the tool’s reasoning and actions. The right panel shows a preview of the actions on the machine you set up for computer use. Select Finish testing [!TIP] If the result isn’t what you expect, go to the configuration page and refine your instructions. Add more details to improve accuracy and test again. Allow sufficient time between tests to ensure the previous Computer use task has been fully completed before starting a new one. Setting up email response capabilities Return to the Tools tab and select + Add a tool Search for Send an email (V2) (Office 365 Outlook) and select it Select Add and configure Update its name to Reply to email Update the description to: Use this operation to reply to the email received Under Additional details, set Credentials to use to Maker-provided credentials Customize the To input and set its Description to: Use the &quot;from&quot; email of the triggering received email. Customize the Subject input and set its Description to: Write the email subject. Customize the Body input and set its Description to: Write the email body using HTML and highlight the requested data. Click Save to finalize the tool configuration Configuring agent instructions and AI settings Navigate to Overview tab and then Edit the Instructions Paste the following comprehensive instructions: When a financial portfolio related request is received, identify the Portfolio ID and search for the requested data using &lt;Look up portfolio data&gt;. Once you have gathered the financial portfolio information, use the &lt;Reply to email&gt; tool to reply to the original email you received. Do not respond with data beyond what was requested. [!IMPORTANT] For each of the placeholder &lt;…&gt; in the description, use / to insert the tools you just configured in your instructions. Save the instructions Go to the agent’s Settings, and in the Knowledge section disable the Use general knowledge to ground agent responses only to data retrieved from CUA Save the settings Testing your complete agent Send a test email from an email address of your preference to your training user’s email account with Subject: Portfolio data request and Body: Hi! I hope you&#39;re doing well! I&#39;m looking for the portfolio manager and value of portfolio #44123BCD. Much appreciated. Thanks! Make sure you receive the email in your training user’s inbox, in outlook.office.com In the Overview tab, go to the Triggers section and select Test trigger Select the trigger instance and then Start testing Check your emails for the agent’s reply. [!TIP] Monitor the Computer use tool’s actions in the Test chat window or through the agent’s Activity page. In the Activity page select the current run and switch from Activity map to Transcript to get a real-time view of all the steps of the Computer use tool along with their respective screenshots. This view is especially useful in autonomous agent runs. [!NOTE] Send an additional email request for another portfolio ID and observe the results. 🏅 Congratulations! You’ve completed Use Case #2! 🏆 Summary of learnings True learning comes from doing, questioning, and reflecting - so let’s put your skills to the test. To maximize the impact of autonomous agents for legacy system integration: Use triggers effectively – Automate business processes based on real-world events Simulate human actions with Computer use – Enable automation even when APIs are unavailable Integrate communication tools – Ensure timely, professional responses to user requests Test and iterate – Continuously refine agent instructions and tool configurations for reliability Conclusions and recommendations Automation golden rules: Always validate environment and licensing prerequisites before starting Use pass-through credentials with caution and document access controls Test each automation step independently before full workflow testing Monitor agent activity and logs for troubleshooting Regularly review and update agent instructions for accuracy Document all configurations for future maintenance By following these principles, you’ll enable secure, scalable, and efficient automation for legacy systems, empowering your organization to make faster, data-driven decisions." />
<meta property="og:description" content="Autonomous Portfolio Lookup Agent with Computer-Using Agents (CUA) Build an autonomous Copilot Studio agent that retrieves financial portfolio data from internal legacy systems that lack API connectivity. 🧭 Lab Details Level Persona Duration Purpose 200 Maker/Developer 30 minutes After completing this lab, participants will be able to build an autonomous agent in Microsoft Copilot Studio that uses the Computer use tool to simulate human interaction with legacy systems and integrates Microsoft 365 Outlook to handle email-based data requests and responses. 📚 Table of Contents Why This Matters Introduction Core Concepts Overview Documentation and Additional Training Links Prerequisites Summary of Targets Use Cases Covered Instructions by Use Case Use Case #1: Create and Configure an Autonomous Agent Use Case #2: Add Computer Use and Email Connector 🤔 Why This Matters Legacy systems without APIs create major roadblocks for automation. Traditional RPA often relies on fragile screen-scraping or manual workarounds, which slow down decision-making, increase errors, and reduce productivity. This lab introduces Microsoft Copilot Studio and Computer Using Agents (CUA) as a smarter solution. By simulating human interaction with internal systems, CUAs can securely access and process data - without needing API integration. You’ll learn to build an autonomous agent that delivers faster responses, reduces manual workload, and enables real-time, informed decisions. 🌐 Introduction In this lab, you’ll learn how to build an autonomous agent using Microsoft Copilot Studio. This agent will simulate human interaction with a legacy internal system to retrieve financial portfolio data without requiring direct API access. Real-world example: A financial advisor needs quick access to key portfolio details - such as client name, portfolio value, and assigned manager - to prepare for meetings, review performance, resolve issues, or recommend rebalancing. However, this data resides in a legacy system that lacks an API and is restricted from direct access. Traditional RPA tools may fall short in such scenarios. They rely on fragile screen-scraping and require constant maintenance, making them unreliable and costly for dynamic, real-time use cases. As a result, advisors must depend on back-office teams to retrieve information, causing delays, inefficiencies, and a higher risk of errors - ultimately limiting their ability to make timely, informed decisions. By implementing a Copilot Studio agent, advisors can securely and instantly retrieve accurate portfolio data. This improves response times, reduces manual workload, and enhances overall productivity without the limitations of traditional RPA. 🎓 Core Concepts Overview Concept Why it matters Autonomous Agents Enable 24/7 automated responses to user inquiries, reducing manual workload and improving response times while maintaining consistency in support quality. Triggers Events, as simple as “Email received”, that trigger autonomous agents to then automatically detect and process the content and context initially provided. Tools Tools are simple or sophisticated connectors that the Copilot Studio orchestrator can invoke in response to user queries or business events. Computer use tool Enables the agent to interact with any system that has a graphical user interface. It works with websites and desktop apps by selecting buttons, choosing menus, and entering text into fields on the screen. It performs the task on a computer you set up using a virtual mouse and keyboard, enabling agents to complete tasks even when there isn’t an API to connect to the system directly. If a person can use an app or website, Computer use can too. Hosted browser The hosted browser runs in a Microsoft-managed environment and lets you get started with Computer use quickly without any machine setup. It provides both web automation using Microsoft Edge and access to built-in Windows applications. 📄 Documentation and Additional Training Links Microsoft Copilot Studio Documentation Copilot Studio Triggers Use connectors in Copilot Studio Office 365 Outlook Connector Automate web and desktop apps with computer use ✅ Prerequisites Access to Microsoft Copilot Studio with appropriate licensing Office 365 environment with Outlook integration enabled 🎯 Summary of Targets In this lab, you’ll build an autonomous portfolio lookup agent that retrieves portfolio information from an internal legacy system. By the end of the lab, you will: Create and configure an autonomous agent with email triggers for automatic activation Add a Computer use tool to simulate the process of a human user retrieving information from a website by logging into a computer, navigating through the website’s graphical user interface, performing searches, and extracting the required data Configure email response tools that reply professionally with proper formatting Test the complete workflow with realistic scenarios and various requests 🧩 Use Cases Covered Step Use Case Value added Effort 1 Create and Configure an Autonomous Agent Establishes the foundation for automated email processing with intelligent trigger configuration 10 min 2 Add Computer Use and Email Connector Enables automated data retrieval from a legacy internal system lacking API connectivity, without requiring backend access or system modifications, by implementing a non-intrusive integration layer. Delivers comprehensive, automated email responses containing only the specifically requested data. 10 min 🛠️ Instructions by Use Case 🔄 Use Case #1: Create and Configure an Autonomous Agent Set up the foundational autonomous agent with email triggers that automatically activates when email requests arrive. Use case Value added Estimated effort Create and Configure an Autonomous Agent Establishes the foundation for automated email processing with intelligent trigger configuration 5 min Summary of tasks You will create a new autonomous agent in Microsoft Copilot Studio, configure its identity, and set up an email trigger using the Microsoft 365 Outlook connector. Scenario: To automate portfolio lookups, the agent must be able to detect incoming email requests and initiate the appropriate automation flow based on subject line filtering. Objective Learn how to create and configure an autonomous agent that listens for specific email triggers and prepares to launch automation tasks in response. Step-by-step instructions Creating the agent and trigger setup Navigate to copilotstudio.microsoft.com Make sure you’re in the correct environment by looking at the top right corner. In these labs, the environment name should start with ‘DEV - ‘ Go to the Solutions menu (located in the left-hand menu under the ellipsis ...) Select the solution you had created previously for your labs Select New and choose Agent Select Configure to bypass the initial setup wizard Name your agent Portfolio Lookup Agent Select Create Configuring email triggers Scroll down to the triggers section and click +Add trigger Search and select When a new email arrives (V3) (Office 365 Outlook) Select Next Rename the trigger to When a portfolio lookup email arrives Select Next In the Subject Filter (Optional) field, enter Portfolio to filter emails that contain the word “Portfolio” in the subject line Finally Create trigger 🏅 Congratulations! You’ve completed Use Case #1! 🖥️ Use Case #2: Add Computer Use and Email Connector Configure a Computer use tool that logs into a computer, navigates through a website, searches and retrieves financial portfolio data. Then use the Office 365 Outlook connector to reply with the requested data. Use case Value added Estimated effort Add Computer Use and Email Connector Enables automated data retrieval from a legacy internal system lacking API connectivity, without requiring backend access or system modifications, by implementing a non-intrusive integration layer. Delivers comprehensive, automated email responses containing only the specifically requested data. 10 min Summary of tasks You will configure the Computer use tool to simulate GUI-based data retrieval, set up the Send an email tool for automated responses, and define the agent’s behavior and testing flow. Scenario: To complete the automation loop, the agent must retrieve portfolio data from a legacy web interface using desktop simulation and respond to email requests with accurate, formatted information. Objective Learn how to integrate and configure tools for desktop automation and email communication, define agent instructions, and test the full end-to-end workflow from trigger to response. Step-by-step instructions Configuring the Computer use tool Navigate to Tools in the top-level menu Select + Add a tool Select + New tool Select Computer use Add the following Instructions: 1. Go to https://computerusedemos.blob.core.windows.net/web/Portfolio/index.html. 2. Enter the Portfolio ID in the &quot;Enter Portfolio ID&quot; search field and click on the &quot;Search&quot; button. 3. Retrieve the &quot;Client Name&quot;, &quot;Portfolio Value&quot; and &quot;Manager&quot; values exactly as shown. 4. Return those three values as the final output. If no portfolio data is found, reply that you couldn&#39;t find a portfolio with the specified ID. Keep the box Use hosted browser checked to create a connection to the hosted browser Select Add and configure Update the Name of the Computer use tool as Look up portfolio data Update the Description as Search and retrieve financial portfolio data In the Inputs section select + Add input Enter name Portfolio ID and description The ID of the portfolio and select Done [!TIP] During execution, Computer use combines your instructions with the input values to complete the task. Select Save Testing the Computer use tool In the Instructions section, select the Test button on the right Add the sample value 44123BCD and select Test now Observe the Computer use tool logging into the computer and performing the requested actions: The left panel shows your instructions and a step-by-step log of the tool’s reasoning and actions. The right panel shows a preview of the actions on the machine you set up for computer use. Select Finish testing [!TIP] If the result isn’t what you expect, go to the configuration page and refine your instructions. Add more details to improve accuracy and test again. Allow sufficient time between tests to ensure the previous Computer use task has been fully completed before starting a new one. Setting up email response capabilities Return to the Tools tab and select + Add a tool Search for Send an email (V2) (Office 365 Outlook) and select it Select Add and configure Update its name to Reply to email Update the description to: Use this operation to reply to the email received Under Additional details, set Credentials to use to Maker-provided credentials Customize the To input and set its Description to: Use the &quot;from&quot; email of the triggering received email. Customize the Subject input and set its Description to: Write the email subject. Customize the Body input and set its Description to: Write the email body using HTML and highlight the requested data. Click Save to finalize the tool configuration Configuring agent instructions and AI settings Navigate to Overview tab and then Edit the Instructions Paste the following comprehensive instructions: When a financial portfolio related request is received, identify the Portfolio ID and search for the requested data using &lt;Look up portfolio data&gt;. Once you have gathered the financial portfolio information, use the &lt;Reply to email&gt; tool to reply to the original email you received. Do not respond with data beyond what was requested. [!IMPORTANT] For each of the placeholder &lt;…&gt; in the description, use / to insert the tools you just configured in your instructions. Save the instructions Go to the agent’s Settings, and in the Knowledge section disable the Use general knowledge to ground agent responses only to data retrieved from CUA Save the settings Testing your complete agent Send a test email from an email address of your preference to your training user’s email account with Subject: Portfolio data request and Body: Hi! I hope you&#39;re doing well! I&#39;m looking for the portfolio manager and value of portfolio #44123BCD. Much appreciated. Thanks! Make sure you receive the email in your training user’s inbox, in outlook.office.com In the Overview tab, go to the Triggers section and select Test trigger Select the trigger instance and then Start testing Check your emails for the agent’s reply. [!TIP] Monitor the Computer use tool’s actions in the Test chat window or through the agent’s Activity page. In the Activity page select the current run and switch from Activity map to Transcript to get a real-time view of all the steps of the Computer use tool along with their respective screenshots. This view is especially useful in autonomous agent runs. [!NOTE] Send an additional email request for another portfolio ID and observe the results. 🏅 Congratulations! You’ve completed Use Case #2! 🏆 Summary of learnings True learning comes from doing, questioning, and reflecting - so let’s put your skills to the test. To maximize the impact of autonomous agents for legacy system integration: Use triggers effectively – Automate business processes based on real-world events Simulate human actions with Computer use – Enable automation even when APIs are unavailable Integrate communication tools – Ensure timely, professional responses to user requests Test and iterate – Continuously refine agent instructions and tool configurations for reliability Conclusions and recommendations Automation golden rules: Always validate environment and licensing prerequisites before starting Use pass-through credentials with caution and document access controls Test each automation step independently before full workflow testing Monitor agent activity and logs for troubleshooting Regularly review and update agent instructions for accuracy Document all configurations for future maintenance By following these principles, you’ll enable secure, scalable, and efficient automation for legacy systems, empowering your organization to make faster, data-driven decisions." />
<link rel="canonical" href="http://0.0.0.0:4000/mcs-labs/labs/autonomous-cua/" />
<meta property="og:url" content="http://0.0.0.0:4000/mcs-labs/labs/autonomous-cua/" />
<meta property="og:site_name" content="Microsoft Copilot Studio Labs" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-10-08T15:03:33-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Autonomous Agent with Computer-Using Agents" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-10-08T15:03:33-05:00","datePublished":"2025-10-08T15:03:33-05:00","description":"Autonomous Portfolio Lookup Agent with Computer-Using Agents (CUA) Build an autonomous Copilot Studio agent that retrieves financial portfolio data from internal legacy systems that lack API connectivity. 🧭 Lab Details Level Persona Duration Purpose 200 Maker/Developer 30 minutes After completing this lab, participants will be able to build an autonomous agent in Microsoft Copilot Studio that uses the Computer use tool to simulate human interaction with legacy systems and integrates Microsoft 365 Outlook to handle email-based data requests and responses. 📚 Table of Contents Why This Matters Introduction Core Concepts Overview Documentation and Additional Training Links Prerequisites Summary of Targets Use Cases Covered Instructions by Use Case Use Case #1: Create and Configure an Autonomous Agent Use Case #2: Add Computer Use and Email Connector 🤔 Why This Matters Legacy systems without APIs create major roadblocks for automation. Traditional RPA often relies on fragile screen-scraping or manual workarounds, which slow down decision-making, increase errors, and reduce productivity. This lab introduces Microsoft Copilot Studio and Computer Using Agents (CUA) as a smarter solution. By simulating human interaction with internal systems, CUAs can securely access and process data - without needing API integration. You’ll learn to build an autonomous agent that delivers faster responses, reduces manual workload, and enables real-time, informed decisions. 🌐 Introduction In this lab, you’ll learn how to build an autonomous agent using Microsoft Copilot Studio. This agent will simulate human interaction with a legacy internal system to retrieve financial portfolio data without requiring direct API access. Real-world example: A financial advisor needs quick access to key portfolio details - such as client name, portfolio value, and assigned manager - to prepare for meetings, review performance, resolve issues, or recommend rebalancing. However, this data resides in a legacy system that lacks an API and is restricted from direct access. Traditional RPA tools may fall short in such scenarios. They rely on fragile screen-scraping and require constant maintenance, making them unreliable and costly for dynamic, real-time use cases. As a result, advisors must depend on back-office teams to retrieve information, causing delays, inefficiencies, and a higher risk of errors - ultimately limiting their ability to make timely, informed decisions. By implementing a Copilot Studio agent, advisors can securely and instantly retrieve accurate portfolio data. This improves response times, reduces manual workload, and enhances overall productivity without the limitations of traditional RPA. 🎓 Core Concepts Overview Concept Why it matters Autonomous Agents Enable 24/7 automated responses to user inquiries, reducing manual workload and improving response times while maintaining consistency in support quality. Triggers Events, as simple as “Email received”, that trigger autonomous agents to then automatically detect and process the content and context initially provided. Tools Tools are simple or sophisticated connectors that the Copilot Studio orchestrator can invoke in response to user queries or business events. Computer use tool Enables the agent to interact with any system that has a graphical user interface. It works with websites and desktop apps by selecting buttons, choosing menus, and entering text into fields on the screen. It performs the task on a computer you set up using a virtual mouse and keyboard, enabling agents to complete tasks even when there isn’t an API to connect to the system directly. If a person can use an app or website, Computer use can too. Hosted browser The hosted browser runs in a Microsoft-managed environment and lets you get started with Computer use quickly without any machine setup. It provides both web automation using Microsoft Edge and access to built-in Windows applications. 📄 Documentation and Additional Training Links Microsoft Copilot Studio Documentation Copilot Studio Triggers Use connectors in Copilot Studio Office 365 Outlook Connector Automate web and desktop apps with computer use ✅ Prerequisites Access to Microsoft Copilot Studio with appropriate licensing Office 365 environment with Outlook integration enabled 🎯 Summary of Targets In this lab, you’ll build an autonomous portfolio lookup agent that retrieves portfolio information from an internal legacy system. By the end of the lab, you will: Create and configure an autonomous agent with email triggers for automatic activation Add a Computer use tool to simulate the process of a human user retrieving information from a website by logging into a computer, navigating through the website’s graphical user interface, performing searches, and extracting the required data Configure email response tools that reply professionally with proper formatting Test the complete workflow with realistic scenarios and various requests 🧩 Use Cases Covered Step Use Case Value added Effort 1 Create and Configure an Autonomous Agent Establishes the foundation for automated email processing with intelligent trigger configuration 10 min 2 Add Computer Use and Email Connector Enables automated data retrieval from a legacy internal system lacking API connectivity, without requiring backend access or system modifications, by implementing a non-intrusive integration layer. Delivers comprehensive, automated email responses containing only the specifically requested data. 10 min 🛠️ Instructions by Use Case 🔄 Use Case #1: Create and Configure an Autonomous Agent Set up the foundational autonomous agent with email triggers that automatically activates when email requests arrive. Use case Value added Estimated effort Create and Configure an Autonomous Agent Establishes the foundation for automated email processing with intelligent trigger configuration 5 min Summary of tasks You will create a new autonomous agent in Microsoft Copilot Studio, configure its identity, and set up an email trigger using the Microsoft 365 Outlook connector. Scenario: To automate portfolio lookups, the agent must be able to detect incoming email requests and initiate the appropriate automation flow based on subject line filtering. Objective Learn how to create and configure an autonomous agent that listens for specific email triggers and prepares to launch automation tasks in response. Step-by-step instructions Creating the agent and trigger setup Navigate to copilotstudio.microsoft.com Make sure you’re in the correct environment by looking at the top right corner. In these labs, the environment name should start with ‘DEV - ‘ Go to the Solutions menu (located in the left-hand menu under the ellipsis ...) Select the solution you had created previously for your labs Select New and choose Agent Select Configure to bypass the initial setup wizard Name your agent Portfolio Lookup Agent Select Create Configuring email triggers Scroll down to the triggers section and click +Add trigger Search and select When a new email arrives (V3) (Office 365 Outlook) Select Next Rename the trigger to When a portfolio lookup email arrives Select Next In the Subject Filter (Optional) field, enter Portfolio to filter emails that contain the word “Portfolio” in the subject line Finally Create trigger 🏅 Congratulations! You’ve completed Use Case #1! 🖥️ Use Case #2: Add Computer Use and Email Connector Configure a Computer use tool that logs into a computer, navigates through a website, searches and retrieves financial portfolio data. Then use the Office 365 Outlook connector to reply with the requested data. Use case Value added Estimated effort Add Computer Use and Email Connector Enables automated data retrieval from a legacy internal system lacking API connectivity, without requiring backend access or system modifications, by implementing a non-intrusive integration layer. Delivers comprehensive, automated email responses containing only the specifically requested data. 10 min Summary of tasks You will configure the Computer use tool to simulate GUI-based data retrieval, set up the Send an email tool for automated responses, and define the agent’s behavior and testing flow. Scenario: To complete the automation loop, the agent must retrieve portfolio data from a legacy web interface using desktop simulation and respond to email requests with accurate, formatted information. Objective Learn how to integrate and configure tools for desktop automation and email communication, define agent instructions, and test the full end-to-end workflow from trigger to response. Step-by-step instructions Configuring the Computer use tool Navigate to Tools in the top-level menu Select + Add a tool Select + New tool Select Computer use Add the following Instructions: 1. Go to https://computerusedemos.blob.core.windows.net/web/Portfolio/index.html. 2. Enter the Portfolio ID in the &quot;Enter Portfolio ID&quot; search field and click on the &quot;Search&quot; button. 3. Retrieve the &quot;Client Name&quot;, &quot;Portfolio Value&quot; and &quot;Manager&quot; values exactly as shown. 4. Return those three values as the final output. If no portfolio data is found, reply that you couldn&#39;t find a portfolio with the specified ID. Keep the box Use hosted browser checked to create a connection to the hosted browser Select Add and configure Update the Name of the Computer use tool as Look up portfolio data Update the Description as Search and retrieve financial portfolio data In the Inputs section select + Add input Enter name Portfolio ID and description The ID of the portfolio and select Done [!TIP] During execution, Computer use combines your instructions with the input values to complete the task. Select Save Testing the Computer use tool In the Instructions section, select the Test button on the right Add the sample value 44123BCD and select Test now Observe the Computer use tool logging into the computer and performing the requested actions: The left panel shows your instructions and a step-by-step log of the tool’s reasoning and actions. The right panel shows a preview of the actions on the machine you set up for computer use. Select Finish testing [!TIP] If the result isn’t what you expect, go to the configuration page and refine your instructions. Add more details to improve accuracy and test again. Allow sufficient time between tests to ensure the previous Computer use task has been fully completed before starting a new one. Setting up email response capabilities Return to the Tools tab and select + Add a tool Search for Send an email (V2) (Office 365 Outlook) and select it Select Add and configure Update its name to Reply to email Update the description to: Use this operation to reply to the email received Under Additional details, set Credentials to use to Maker-provided credentials Customize the To input and set its Description to: Use the &quot;from&quot; email of the triggering received email. Customize the Subject input and set its Description to: Write the email subject. Customize the Body input and set its Description to: Write the email body using HTML and highlight the requested data. Click Save to finalize the tool configuration Configuring agent instructions and AI settings Navigate to Overview tab and then Edit the Instructions Paste the following comprehensive instructions: When a financial portfolio related request is received, identify the Portfolio ID and search for the requested data using &lt;Look up portfolio data&gt;. Once you have gathered the financial portfolio information, use the &lt;Reply to email&gt; tool to reply to the original email you received. Do not respond with data beyond what was requested. [!IMPORTANT] For each of the placeholder &lt;…&gt; in the description, use / to insert the tools you just configured in your instructions. Save the instructions Go to the agent’s Settings, and in the Knowledge section disable the Use general knowledge to ground agent responses only to data retrieved from CUA Save the settings Testing your complete agent Send a test email from an email address of your preference to your training user’s email account with Subject: Portfolio data request and Body: Hi! I hope you&#39;re doing well! I&#39;m looking for the portfolio manager and value of portfolio #44123BCD. Much appreciated. Thanks! Make sure you receive the email in your training user’s inbox, in outlook.office.com In the Overview tab, go to the Triggers section and select Test trigger Select the trigger instance and then Start testing Check your emails for the agent’s reply. [!TIP] Monitor the Computer use tool’s actions in the Test chat window or through the agent’s Activity page. In the Activity page select the current run and switch from Activity map to Transcript to get a real-time view of all the steps of the Computer use tool along with their respective screenshots. This view is especially useful in autonomous agent runs. [!NOTE] Send an additional email request for another portfolio ID and observe the results. 🏅 Congratulations! You’ve completed Use Case #2! 🏆 Summary of learnings True learning comes from doing, questioning, and reflecting - so let’s put your skills to the test. To maximize the impact of autonomous agents for legacy system integration: Use triggers effectively – Automate business processes based on real-world events Simulate human actions with Computer use – Enable automation even when APIs are unavailable Integrate communication tools – Ensure timely, professional responses to user requests Test and iterate – Continuously refine agent instructions and tool configurations for reliability Conclusions and recommendations Automation golden rules: Always validate environment and licensing prerequisites before starting Use pass-through credentials with caution and document access controls Test each automation step independently before full workflow testing Monitor agent activity and logs for troubleshooting Regularly review and update agent instructions for accuracy Document all configurations for future maintenance By following these principles, you’ll enable secure, scalable, and efficient automation for legacy systems, empowering your organization to make faster, data-driven decisions.","headline":"Autonomous Agent with Computer-Using Agents","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/mcs-labs/labs/autonomous-cua/"},"url":"http://0.0.0.0:4000/mcs-labs/labs/autonomous-cua/"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
    <header class="site-header">
        <div class="container">
            <h1><a href="/mcs-labs/">Microsoft Copilot Studio Labs</a></h1>
            <nav>
                <a href="/mcs-labs/">Home</a>
                <a href="/mcs-labs/labs/">All Labs</a>
            </nav>
        </div>
    </header>

    <main class="site-content">
        <div class="container">
            <article class="lab-content">
    <header class="lab-header">
        <h1>Autonomous Agent with Computer-Using Agents</h1>
        
        <div class="lab-meta">
            <span class="duration">⏱️ 150 minutes</span>
            
            <span class="difficulty">📊 300</span>
            
        </div>
        
    </header>

    <div class="lab-body">
        <h1 id="autonomous-portfolio-lookup-agent-with-computer-using-agents-cua">Autonomous Portfolio Lookup Agent with Computer-Using Agents (CUA)</h1>

<p>Build an autonomous Copilot Studio agent that retrieves financial portfolio data from internal legacy systems that lack API connectivity.</p>

<hr />

<h2 id="-lab-details">🧭 Lab Details</h2>

<table>
  <thead>
    <tr>
      <th>Level</th>
      <th>Persona</th>
      <th>Duration</th>
      <th>Purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>200</td>
      <td>Maker/Developer</td>
      <td>30 minutes</td>
      <td>After completing this lab, participants will be able to build an autonomous agent in Microsoft Copilot Studio that uses the Computer use tool to simulate human interaction with legacy systems and integrates Microsoft 365 Outlook to handle email-based data requests and responses.</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-table-of-contents">📚 Table of Contents</h2>

<ul>
  <li><a href="#-why-this-matters">Why This Matters</a></li>
  <li><a href="#-introduction">Introduction</a></li>
  <li><a href="#-core-concepts-overview">Core Concepts Overview</a></li>
  <li><a href="#-documentation-and-additional-training-links">Documentation and Additional Training Links</a></li>
  <li><a href="#-prerequisites">Prerequisites</a></li>
  <li><a href="#-summary-of-targets">Summary of Targets</a></li>
  <li><a href="#-use-cases-covered">Use Cases Covered</a></li>
  <li><a href="#️-instructions-by-use-case">Instructions by Use Case</a>
    <ul>
      <li><a href="#-use-case-1-create-and-configure-an-autonomous-agent">Use Case #1: Create and Configure an Autonomous Agent</a></li>
      <li><a href="#️-use-case-2-add-computer-use-and-email-connector">Use Case #2: Add Computer Use and Email Connector</a></li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="-why-this-matters">🤔 Why This Matters</h2>

<p>Legacy systems without APIs create major roadblocks for automation. Traditional RPA often relies on fragile screen-scraping or manual workarounds, which slow down decision-making, increase errors, and reduce productivity.</p>

<p>This lab introduces Microsoft Copilot Studio and Computer Using Agents (CUA) as a smarter solution. By simulating human interaction with internal systems, CUAs can securely access and process data - without needing API integration. You’ll learn to build an autonomous agent that delivers faster responses, reduces manual workload, and enables real-time, informed decisions.</p>

<hr />

<h2 id="-introduction">🌐 Introduction</h2>

<p>In this lab, you’ll learn how to build an autonomous agent using Microsoft Copilot Studio. This agent will simulate human interaction with a legacy internal system to retrieve financial portfolio data without requiring direct API access.</p>

<p><strong>Real-world example:</strong> A financial advisor needs quick access to key portfolio details - such as client name, portfolio value, and assigned manager - to prepare for meetings, review performance, resolve issues, or recommend rebalancing. However, this data resides in a legacy system that lacks an API and is restricted from direct access.</p>

<p>Traditional RPA tools may fall short in such scenarios. They rely on fragile screen-scraping and require constant maintenance, making them unreliable and costly for dynamic, real-time use cases.</p>

<p>As a result, advisors must depend on back-office teams to retrieve information, causing delays, inefficiencies, and a higher risk of errors - ultimately limiting their ability to make timely, informed decisions.</p>

<p>By implementing a Copilot Studio agent, advisors can securely and instantly retrieve accurate portfolio data. This improves response times, reduces manual workload, and enhances overall productivity without the limitations of traditional RPA.</p>

<hr />

<h2 id="-core-concepts-overview">🎓 Core Concepts Overview</h2>

<table>
  <thead>
    <tr>
      <th>Concept</th>
      <th>Why it matters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Autonomous Agents</strong></td>
      <td>Enable 24/7 automated responses to user inquiries, reducing manual workload and improving response times while maintaining consistency in support quality.</td>
    </tr>
    <tr>
      <td><strong>Triggers</strong></td>
      <td>Events, as simple as “Email received”, that trigger autonomous agents to then automatically detect and process the content and context initially provided.</td>
    </tr>
    <tr>
      <td><strong>Tools</strong></td>
      <td>Tools are simple or sophisticated connectors that the Copilot Studio orchestrator can invoke in response to user queries or business events.</td>
    </tr>
    <tr>
      <td><strong>Computer use tool</strong></td>
      <td>Enables the agent to interact with any system that has a graphical user interface. It works with websites and desktop apps by selecting buttons, choosing menus, and entering text into fields on the screen. It performs the task on a computer you set up using a virtual mouse and keyboard, enabling agents to complete tasks even when there isn’t an API to connect to the system directly. If a person can use an app or website, Computer use can too.</td>
    </tr>
    <tr>
      <td><strong>Hosted browser</strong></td>
      <td>The hosted browser runs in a Microsoft-managed environment and lets you get started with Computer use quickly without any machine setup. It provides both web automation using Microsoft Edge and access to built-in Windows applications.</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-documentation-and-additional-training-links">📄 Documentation and Additional Training Links</h2>

<ul>
  <li><a href="https://learn.microsoft.com/microsoft-copilot-studio/">Microsoft Copilot Studio Documentation</a></li>
  <li><a href="https://learn.microsoft.com/microsoft-copilot-studio/authoring-triggers-about">Copilot Studio Triggers</a></li>
  <li><a href="https://learn.microsoft.com/microsoft-copilot-studio/advanced-connectors">Use connectors in Copilot Studio</a></li>
  <li><a href="https://learn.microsoft.com/connectors/office365/">Office 365 Outlook Connector</a></li>
  <li><a href="https://learn.microsoft.com/microsoft-copilot-studio/computer-use">Automate web and desktop apps with computer use</a></li>
</ul>

<hr />

<h2 id="-prerequisites">✅ Prerequisites</h2>

<ul>
  <li>Access to Microsoft Copilot Studio with appropriate licensing</li>
  <li>Office 365 environment with Outlook integration enabled</li>
</ul>

<hr />

<h2 id="-summary-of-targets">🎯 Summary of Targets</h2>

<p>In this lab, you’ll build an autonomous portfolio lookup agent that retrieves portfolio information from an internal legacy system. By the end of the lab, you will:</p>

<ul>
  <li>Create and configure an autonomous agent with email triggers for automatic activation</li>
  <li>Add a Computer use tool to simulate the process of a human user retrieving information from a website by logging into a computer, navigating through the website’s graphical user interface, performing searches, and extracting the required data</li>
  <li>Configure email response tools that reply professionally with proper formatting</li>
  <li>Test the complete workflow with realistic scenarios and various requests</li>
</ul>

<hr />

<h2 id="-use-cases-covered">🧩 Use Cases Covered</h2>

<table>
  <thead>
    <tr>
      <th>Step</th>
      <th>Use Case</th>
      <th>Value added</th>
      <th>Effort</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td><a href="#-use-case-1-create-and-configure-an-autonomous-agent">Create and Configure an Autonomous Agent</a></td>
      <td>Establishes the foundation for automated email processing with intelligent trigger configuration</td>
      <td>10 min</td>
    </tr>
    <tr>
      <td>2</td>
      <td><a href="#️-use-case-2-add-computer-use-and-email-connector">Add Computer Use and Email Connector</a></td>
      <td>Enables automated data retrieval from a legacy internal system lacking API connectivity, without requiring backend access or system modifications, by implementing a non-intrusive integration layer. Delivers comprehensive, automated email responses containing only the specifically requested data.</td>
      <td>10 min</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="️-instructions-by-use-case">🛠️ Instructions by Use Case</h2>

<hr />

<h2 id="-use-case-1-create-and-configure-an-autonomous-agent">🔄 Use Case #1: Create and Configure an Autonomous Agent</h2>

<p>Set up the foundational autonomous agent with email triggers that automatically activates when email requests arrive.</p>

<table>
  <thead>
    <tr>
      <th>Use case</th>
      <th>Value added</th>
      <th>Estimated effort</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Create and Configure an Autonomous Agent</td>
      <td>Establishes the foundation for automated email processing with intelligent trigger configuration</td>
      <td>5 min</td>
    </tr>
  </tbody>
</table>

<p><strong>Summary of tasks</strong></p>

<p>You will create a new autonomous agent in Microsoft Copilot Studio, configure its identity, and set up an email trigger using the Microsoft 365 Outlook connector.</p>

<p><strong>Scenario:</strong> To automate portfolio lookups, the agent must be able to detect incoming email requests and initiate the appropriate automation flow based on subject line filtering.</p>

<h3 id="objective">Objective</h3>

<p>Learn how to create and configure an autonomous agent that listens for specific email triggers and prepares to launch automation tasks in response.</p>

<hr />

<h3 id="step-by-step-instructions">Step-by-step instructions</h3>

<h4 id="creating-the-agent-and-trigger-setup">Creating the agent and trigger setup</h4>

<ol>
  <li>
    <p>Navigate to <a href="https://copilotstudio.microsoft.com">copilotstudio.microsoft.com</a></p>
  </li>
  <li>
    <p>Make sure you’re in the correct environment by looking at the top right corner. In these labs, the environment name should start with <strong>‘DEV - ‘</strong></p>
  </li>
  <li>
    <p>Go to the <strong>Solutions</strong> menu (located in the left-hand menu under the ellipsis <code class="language-plaintext highlighter-rouge">...</code>)</p>
  </li>
  <li>
    <p>Select the solution you had created previously for your labs</p>
  </li>
  <li>
    <p>Select <strong>New</strong> and choose <strong>Agent</strong></p>
  </li>
  <li>
    <p>Select <strong>Configure</strong> to bypass the initial setup wizard</p>
  </li>
  <li>
    <p>Name your agent <code class="language-plaintext highlighter-rouge">Portfolio Lookup Agent</code></p>
  </li>
  <li>
    <p>Select <strong>Create</strong></p>
  </li>
</ol>

<h4 id="configuring-email-triggers">Configuring email triggers</h4>

<ol>
  <li>
    <p>Scroll down to the triggers section and click <strong>+Add trigger</strong></p>
  </li>
  <li>
    <p>Search and select <code class="language-plaintext highlighter-rouge">When a new email arrives (V3) (Office 365 Outlook)</code></p>
  </li>
  <li>
    <p>Select <strong>Next</strong></p>
  </li>
  <li>
    <p>Rename the trigger to <code class="language-plaintext highlighter-rouge">When a portfolio lookup email arrives</code></p>
  </li>
  <li>
    <p>Select <strong>Next</strong></p>
  </li>
  <li>
    <p>In the <strong>Subject Filter (Optional)</strong> field, enter <code class="language-plaintext highlighter-rouge">Portfolio</code> to filter emails that contain the word “Portfolio” in the subject line</p>
  </li>
  <li>
    <p>Finally <strong>Create trigger</strong></p>
  </li>
</ol>

<hr />

<h3 id="-congratulations-youve-completed-use-case-1">🏅 Congratulations! You’ve completed Use Case #1!</h3>

<hr />

<h2 id="️-use-case-2-add-computer-use-and-email-connector">🖥️ Use Case #2: Add Computer Use and Email Connector</h2>

<p>Configure a Computer use tool that logs into a computer, navigates through a website, searches and retrieves financial portfolio data. Then use the Office 365 Outlook connector to reply with the requested data.</p>

<table>
  <thead>
    <tr>
      <th>Use case</th>
      <th>Value added</th>
      <th>Estimated effort</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Add Computer Use and Email Connector</td>
      <td>Enables automated data retrieval from a legacy internal system lacking API connectivity, without requiring backend access or system modifications, by implementing a non-intrusive integration layer. Delivers comprehensive, automated email responses containing only the specifically requested data.</td>
      <td>10 min</td>
    </tr>
  </tbody>
</table>

<p><strong>Summary of tasks</strong></p>

<p>You will configure the Computer use tool to simulate GUI-based data retrieval, set up the Send an email tool for automated responses, and define the agent’s behavior and testing flow.</p>

<p><strong>Scenario:</strong> To complete the automation loop, the agent must retrieve portfolio data from a legacy web interface using desktop simulation and respond to email requests with accurate, formatted information.</p>

<h3 id="objective-1">Objective</h3>

<p>Learn how to integrate and configure tools for desktop automation and email communication, define agent instructions, and test the full end-to-end workflow from trigger to response.</p>

<hr />

<h3 id="step-by-step-instructions-1">Step-by-step instructions</h3>

<h4 id="configuring-the-computer-use-tool">Configuring the Computer use tool</h4>

<ol>
  <li>
    <p>Navigate to <strong>Tools</strong> in the top-level menu</p>
  </li>
  <li>
    <p>Select <strong>+ Add a tool</strong></p>
  </li>
  <li>
    <p>Select <strong>+ New tool</strong></p>
  </li>
  <li>
    <p>Select <strong>Computer use</strong></p>
  </li>
  <li>
    <p>Add the following <strong>Instructions</strong>:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1. Go to https://computerusedemos.blob.core.windows.net/web/Portfolio/index.html.
 2. Enter the Portfolio ID in the "Enter Portfolio ID" search field and click on the "Search" button.
 3. Retrieve the "Client Name", "Portfolio Value" and "Manager" values exactly as shown.
 4. Return those three values as the final output.
    
 If no portfolio data is found, reply that you couldn't find a portfolio with the specified ID.
</code></pre></div>    </div>
  </li>
  <li>
    <p>Keep the box <strong>Use hosted browser</strong> checked to create a connection to the hosted browser</p>
  </li>
  <li>
    <p>Select <strong>Add and configure</strong></p>
  </li>
  <li>
    <p>Update the <strong>Name</strong> of the Computer use tool as <code class="language-plaintext highlighter-rouge">Look up portfolio data</code></p>
  </li>
  <li>
    <p>Update the <strong>Description</strong> as <code class="language-plaintext highlighter-rouge">Search and retrieve financial portfolio data</code></p>
  </li>
  <li>
    <p>In the <strong>Inputs</strong> section select <strong>+ Add input</strong></p>
  </li>
  <li>
    <p>Enter name <code class="language-plaintext highlighter-rouge">Portfolio ID</code> and description <code class="language-plaintext highlighter-rouge">The ID of the portfolio</code> and select <strong>Done</strong></p>
  </li>
</ol>

<blockquote>
  <p>[!TIP]
During execution, Computer use combines your instructions with the input values to complete the task.</p>
</blockquote>

<ol>
  <li>Select <strong>Save</strong></li>
</ol>

<h4 id="testing-the-computer-use-tool">Testing the Computer use tool</h4>

<ol>
  <li>
    <p>In the <strong>Instructions</strong> section, select the <strong>Test</strong> button on the right</p>
  </li>
  <li>
    <p>Add the sample value <code class="language-plaintext highlighter-rouge">44123BCD</code> and select <strong>Test now</strong></p>
  </li>
  <li>
    <p>Observe the Computer use tool logging into the computer and performing the requested actions:</p>
    <ul>
      <li>The left panel shows your instructions and a step-by-step log of the tool’s reasoning and actions.</li>
      <li>The right panel shows a preview of the actions on the machine you set up for computer use.</li>
    </ul>
  </li>
</ol>

<p><img src="images/test_CUA.jpg" alt="alt text" /></p>

<ol>
  <li>Select <strong>Finish testing</strong></li>
</ol>

<blockquote>
  <p>[!TIP]
If the result isn’t what you expect, go to the configuration page and refine your instructions. Add more details to improve accuracy and test again. Allow sufficient time between tests to ensure the previous Computer use task has been fully completed before starting a new one.</p>
</blockquote>

<h4 id="setting-up-email-response-capabilities">Setting up email response capabilities</h4>

<ol>
  <li>
    <p>Return to the <strong>Tools</strong> tab and select <strong>+ Add a tool</strong></p>
  </li>
  <li>
    <p>Search for <code class="language-plaintext highlighter-rouge">Send an email (V2) (Office 365 Outlook)</code> and select it</p>
  </li>
  <li>
    <p>Select <strong>Add and configure</strong></p>
  </li>
  <li>
    <p>Update its name to <code class="language-plaintext highlighter-rouge">Reply to email</code></p>
  </li>
  <li>
    <p>Update the description to: <code class="language-plaintext highlighter-rouge">Use this operation to reply to the email received</code></p>
  </li>
  <li>
    <p>Under <strong>Additional details</strong>, set <strong>Credentials to use</strong> to <strong>Maker-provided credentials</strong></p>
  </li>
  <li>
    <p>Customize the <strong>To</strong> input and set its <strong>Description</strong> to:
 <code class="language-plaintext highlighter-rouge">Use the "from" email of the triggering received email.</code></p>
  </li>
  <li>
    <p>Customize the <strong>Subject</strong> input and set its <strong>Description</strong> to:
 <code class="language-plaintext highlighter-rouge">Write the email subject.</code></p>
  </li>
  <li>
    <p>Customize the <strong>Body</strong> input and set its <strong>Description</strong> to:
 <code class="language-plaintext highlighter-rouge">Write the email body using HTML and highlight the requested data.</code></p>
  </li>
  <li>
    <p>Click <strong>Save</strong> to finalize the tool configuration</p>
  </li>
</ol>

<h4 id="configuring-agent-instructions-and-ai-settings">Configuring agent instructions and AI settings</h4>

<ol>
  <li>
    <p>Navigate to <strong>Overview</strong> tab and then <strong>Edit</strong> the <strong>Instructions</strong></p>
  </li>
  <li>
    <p>Paste the following comprehensive instructions:</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> When a financial portfolio related request is received, identify the Portfolio ID and search for the requested data using &lt;Look up portfolio data&gt;. Once you have gathered the financial portfolio information, use the &lt;Reply to email&gt;  tool to reply to the original email you received. Do not respond with data beyond what was requested. 
</code></pre></div>    </div>
  </li>
</ol>

<blockquote>
  <p>[!IMPORTANT]
For each of the placeholder &lt;…&gt; in the description, use / to insert the tools you just configured in your instructions.</p>
</blockquote>

<p><img src="images/agent_instructions.jpg" alt="alt text" /></p>

<ol>
  <li>
    <p><strong>Save</strong> the instructions</p>
  </li>
  <li>
    <p>Go to the agent’s <strong>Settings</strong>, and in the Knowledge section <strong>disable</strong> the <strong>Use general knowledge</strong> to ground agent responses only to data retrieved from CUA</p>
  </li>
  <li>
    <p><strong>Save</strong> the settings</p>
  </li>
</ol>

<h4 id="testing-your-complete-agent">Testing your complete agent</h4>

<ol>
  <li>
    <p>Send a test email from an email address of your preference to your training user’s email account with Subject: <code class="language-plaintext highlighter-rouge">Portfolio data request</code> and Body:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hi!

I hope you're doing well!
I'm looking for the portfolio manager and value of portfolio #44123BCD.

Much appreciated.
Thanks!
</code></pre></div>    </div>
  </li>
  <li>
    <p>Make sure you receive the email in your training user’s inbox, in outlook.office.com</p>
  </li>
  <li>
    <p>In the <strong>Overview</strong> tab, go to the <strong>Triggers</strong> section and select <strong>Test trigger</strong></p>
  </li>
  <li>
    <p>Select the trigger instance and then <strong>Start testing</strong></p>
  </li>
</ol>

<p><img src="images/test_trigger.jpg" alt="alt text" /></p>

<ol>
  <li>Check your emails for the agent’s reply.</li>
</ol>

<blockquote>
  <p>[!TIP]</p>
  <ul>
    <li>Monitor the Computer use tool’s actions in the Test chat window or through the agent’s <strong>Activity</strong> page.</li>
    <li>In the <strong>Activity</strong> page select the current run and switch from <strong>Activity map</strong> to <strong>Transcript</strong> to get a real-time view of all the steps of the Computer use tool along with their respective screenshots. This view is especially useful in autonomous agent runs.</li>
  </ul>
</blockquote>

<blockquote>
  <p>[!NOTE]
Send an additional email request for another portfolio ID and observe the results.</p>
</blockquote>

<hr />

<h3 id="-congratulations-youve-completed-use-case-2">🏅 Congratulations! You’ve completed Use Case #2!</h3>

<hr />

<h2 id="-summary-of-learnings">🏆 Summary of learnings</h2>

<p>True learning comes from doing, questioning, and reflecting - so let’s put your skills to the test.</p>

<p>To maximize the impact of autonomous agents for legacy system integration:</p>

<ul>
  <li><strong>Use triggers effectively</strong> – Automate business processes based on real-world events</li>
  <li><strong>Simulate human actions with Computer use</strong> – Enable automation even when APIs are unavailable</li>
  <li><strong>Integrate communication tools</strong> – Ensure timely, professional responses to user requests</li>
  <li><strong>Test and iterate</strong> – Continuously refine agent instructions and tool configurations for reliability</li>
</ul>

<hr />

<h3 id="conclusions-and-recommendations">Conclusions and recommendations</h3>

<p><strong>Automation golden rules:</strong></p>

<ul>
  <li>Always validate environment and licensing prerequisites before starting</li>
  <li>Use pass-through credentials with caution and document access controls</li>
  <li>Test each automation step independently before full workflow testing</li>
  <li>Monitor agent activity and logs for troubleshooting</li>
  <li>Regularly review and update agent instructions for accuracy</li>
  <li>Document all configurations for future maintenance</li>
</ul>

<p>By following these principles, you’ll enable secure, scalable, and efficient automation for legacy systems, empowering your organization to make faster, data-driven decisions.</p>

<hr />


    </div>

    <footer class="lab-footer">
        <div class="lab-navigation">
            
            
            
            
            
            
                
                
                
            
                
                
                
            
                
                
                
            
                
                
                
            
                
                
                
            
                
                
                
            
                
                
                
            
                
                
                
            
                
                
                
            
                
                
                
            
                
                    
                    
            
            
                <a href="/mcs-labs/labs/autonomous-account-news/" class="nav-button prev">
                    ← Autonomous Account News Agent
                </a>
            
            
            
                <a href="/mcs-labs/labs/pipelines-and-source-control/" class="nav-button next">
                    Pipelines and Source Control →
                </a>
            
        </div>
    </footer>
</article>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2025 Microsoft Copilot Studio Labs</p>
        </div>
    </footer>
</body>
</html>