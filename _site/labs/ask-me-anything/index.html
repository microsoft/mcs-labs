<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ask Me Anything Agent | Microsoft Copilot Studio Labs</title>
    <link rel="stylesheet" href="/mcs-labs/assets/css/style.css">
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Ask Me Anything Agent | Microsoft Copilot Studio Labs</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Ask Me Anything Agent" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Create an ‘Ask me anything’ agent for your employees Empower employees with answers that matter – Build an intelligent agent that connects to your knowledge and data. 🧭 Lab Details Level Persona Duration Purpose 200 Maker 40 minutes After completing this lab, participants will be able to create an intelligent “Ask me anything” agent that connects to multiple knowledge sources including SharePoint, ServiceNow, and custom knowledge bases. Participants will learn to configure knowledge prioritization, deploy agents to Microsoft 365 Copilot, and implement AI-powered document analysis with human review workflows. 📚 Table of Contents Why This Matters Introduction Core Concepts Overview Documentation and Additional Training Links Prerequisites Summary of Targets Use Cases Covered Instructions by Use Case Use Case #1: Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source Use Case #2: Configure Suggested Prompts Use Case #3: Deploy to Microsoft 365 Copilot Use Case #4: Knowledge Prioritization Techniques Use Case #5: Create a child IT Support Agent Use Case #6: Add Custom Knowledge Use Case #7: AI Summary and Review of Meeting Notes 🤔 Why This Matters Makers and IT professionals - Tired of employees constantly asking the same questions about policies, benefits, or system status? Frustrated by scattered knowledge across multiple systems? Think of your organization’s knowledge like a library: Without an intelligent agent: Employees waste hours searching through SharePoint folders, submitting IT tickets for simple questions, and interrupting colleagues for information that should be readily available With an intelligent agent: Employees get instant, accurate answers from a single conversational interface that automatically searches across all your knowledge sources with proper citations Common challenges solved by this lab: “I can’t find the leave policy for my country in our SharePoint site” “What’s the status of my ServiceNow incident?” “Can someone help me structure these meeting notes properly?” “I need information from multiple systems but don’t know where to look” This 40-minute investment will save your organization countless hours and improve employee satisfaction by providing instant access to knowledge. 🌐 Introduction In today’s fast-paced business environment, employees need quick access to accurate information from multiple sources. Whether it’s HR policies, IT incident status, or custom knowledge bases, information is often scattered across different systems, making it difficult for employees to find what they need efficiently. Real-world example: Imagine Sarah, a new employee in Germany, needs to understand her leave entitlements. Currently, she might spend 30 minutes navigating through SharePoint folders, trying different search terms, or even asking HR colleagues. With an intelligent “Ask me anything” agent, Sarah simply types “What’s the leave policy for Germany?” and instantly receives the accurate policy document with proper citations, saving time and reducing frustration. This lab teaches you to build a comprehensive solution that transforms how employees interact with organizational knowledge, creating a single conversational interface that intelligently routes questions to the right knowledge sources and provides contextual, accurate responses. 🎓 Core Concepts Overview Concept Why it matters Knowledge Source Integration Connects your agent to multiple data sources (SharePoint, ServiceNow, custom APIs) so employees get comprehensive answers from a single interface, eliminating the need to search multiple systems. Context-Aware Knowledge Prioritization Intelligently routes questions to the most relevant knowledge sources based on user context (location, role, etc.), ensuring employees get personalized and accurate information. Microsoft 365 Copilot Deployment Makes your agent available where employees already work, integrating seamlessly into their daily Microsoft 365 workflow for maximum adoption and convenience. AI-Powered Document Analysis Automates the processing and structuring of unstructured content like meeting notes, reducing manual work while maintaining human oversight for accuracy and approval. 📄 Documentation and Additional Training Links Microsoft Copilot Studio Documentation Knowledge Sources in Copilot Studio Deploy Copilot Studio agents to Microsoft 365 ServiceNow connector for Power Platform Adaptive Cards for Interactive Experiences ✅ Prerequisites Access to Microsoft Copilot Studio with appropriate licensing. Access to SharePoint Online with sample knowledge content. ServiceNow access for incident management integration (demo environment provided). Understanding of basic conversational AI concepts and Microsoft 365 administration. 🎯 Summary of Targets In this lab, you’ll build a comprehensive “Ask me anything” agent that serves as a central knowledge hub for your organization. By the end of the lab, you will: Create an ‘Ask me Anything’ agent and add SharePoint as a knowledge source. Configure suggested prompts for better user guidance. Deploy to Microsoft 365 Copilot for seamless integration. Learn to prioritize knowledge sources based on user context. Add ServiceNow incidents integration for real-time ticket status. Add custom knowledge sources via HTTP requests. Implement AI summary and review of meeting notes with human oversight. 🧩 Use Cases Covered Step Use Case Value added Effort 1 Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source Establishes foundational agent with SharePoint knowledge integration and grounded AI responses 5 min 2 Configure Suggested Prompts Guides users toward the agent’s best capabilities through strategic prompt suggestions 3 min 3 Deploy to Microsoft 365 Copilot Makes the agent available in Microsoft 365 Copilot for seamless user access 5 min 4 Knowledge Prioritization Techniques Implements context-aware knowledge routing for personalized and relevant responses 8 min 5 Use Case #5: Create a child IT Support Agent Discover how scoping for knowledge and tools can also be done through the multi-agent capabilitis. 5 min 6 Add Custom Knowledge Extends knowledge base with custom HTTP endpoints for enterprise system integration 7 min 7 AI Summary and Review of Meeting Notes Automates document analysis with human review workflows for accuracy and approval 7 min 🛠️ Instructions by Use Case 🧱 Use Case #1: Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source Create a foundational intelligent agent with SharePoint integration for grounded AI responses. Use case Value added Estimated effort Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source Establishes foundational agent with SharePoint knowledge integration and grounded AI responses 5 minutes Summary of tasks In this section, you’ll learn how to access the Solutions area of Copilot Studio, create a new agent, and integrate SharePoint as a knowledge source. Scenario: Properly setup your development environment so that you can later easily package and deploy your agents to other environments. Your organization has extensive knowledge stored in SharePoint that needs to be accessible through conversational AI. Objective Create a new agent with SharePoint knowledge integration that provides grounded, cited responses. Step-by-step instructions Navigate to the Copilot Studio home page at copilotstudio.microsoft.com Go to the Solutions menu (located in the left-hand menu under the ellipsis …) Select the solution you had created Select New, and choose Agent Select the Configure tab Name your agent Ask Me Anything Select Create Go to Knowledge Select SharePoint, and paste the SharePoint Knowledge URL and select Add. [!IMPORTANT] For configuration, use the provided values in the Lab Resources (specific per training). Choose Add Test your agent with this question: What&#39;s the Northwind Health Plus Benefits plan? [!TIP] Notice how relevant it is, and how the citations are accurate. This demonstrates the power of grounded AI responses. 🏅 Congratulations! You’ve completed Use Case #1! Test your understanding Key takeaways: Solution Management – Using solutions ensures proper environment management and deployment capabilities Knowledge Integration – SharePoint integration provides immediate access to organizational documents with proper citations Grounded AI – The agent automatically provides source citations, ensuring transparency and trust in responses 🔄 Use Case #2: Configure Suggested Prompts Guide users toward your agent’s best capabilities through strategic prompt suggestions. Use case Value added Estimated effort Configure Suggested Prompts Guides users toward the agent’s best capabilities through strategic prompt suggestions 3 minutes Summary of tasks Suggest things your agent can do to your end-users through carefully crafted prompts. Scenario: Help users discover the full capabilities of your agent by providing clear, actionable suggestions that demonstrate different use cases. Step-by-step instructions Go to the overview tab for your agent Add suggested prompts: Title Prompt Ask me about benefits What&#39;s the Northwind Health Plus Benefits plan? Ask me about policies What&#39;s the leave policy in Germany? Help fill out meeting notes Capture and structure meeting notes Check on an incident What&#39;s the status of INC0007001? Save the prompts [!TIP] Prompts are visibile to the end-user when the agent is deployed as a Copilot agent. 🏅 Congratulations! You’ve completed Use Case #2! Test your understanding How do suggested prompts improve user adoption and engagement with your agent? What makes an effective suggested prompt versus a generic one? 🔄 Use Case #3: Deploy to Microsoft 365 Copilot Make the agent available in Microsoft 365 Copilot for seamless user access. Use case Value added Estimated effort Deploy to Microsoft 365 Copilot Makes the agent available in Microsoft 365 Copilot for seamless user access 5 minutes Summary of tasks Make the agent available in Microsoft 365 Copilot for your users. Scenario: Deploy your agent where employees already work, ensuring maximum adoption by integrating directly into their daily Microsoft 365 workflow. Step-by-step instructions Go to the agent and select Publish Go to Channels Select Teams and Microsoft 365 Copilot Select Add channel (at the bottom right corner) Close the channel pane Publish the agent again. Select Teams and Microsoft 365 Copilot channel tile Select See agent in Microsoft 365 In the Microsoft 365 Copilot experience, the agent description will pop up. Select Add [!TIP] You may need to give it a few tries/minutes the first time you deploy to Microsoft 365 Copilot so it deploys correctly. If encountering issues, try to publish your agent agent. If this doesn’t work, try in Teams instead: Choose See agents in Teams instead. In the new window, if prompted This site is trying to open Microsoft Teams, select Cancel, and the select use the web app instead Test the agent with the benefits prompt [!TIP] If deploying to Teams, prompts won’t be available, so paste the below question: What&#39;s the Northwind Health Plus Benefits plan? 🏅 Congratulations! You’ve completed Use Case #3! Test your understanding Why is deploying to Microsoft 365 Copilot more effective than standalone deployment for enterprise scenarios? What considerations should you have when choosing deployment channels? 🔄 Use Case #4: Knowledge Prioritization Techniques Implement context-aware knowledge routing for personalized and relevant responses. Use case Value added Estimated effort Knowledge Prioritization Techniques Implements context-aware knowledge routing for personalized and relevant responses 8 minutes Summary of tasks In this section, you’ll learn different techniques to help prioritize the right knowledge sources based on context. Scenario: The SharePoint site has different folders for different country leave policies. Asking “What’s the leave policy?” doesn’t return relevant results and seems to randomly pick a leave policy for a country. You need to implement context-aware routing. Step-by-step instructions Let’s start by asking for the user country at the beginning of the conversation. In many situations, this can be obtained from context, either passed from a web page to the agent, or by making an initial call (for example to the Entra ID connector) to get more information about the logged-in user and their location. Setting an office location in Entra ID Start by assigning an office location to your user. Use the Workshop Agent and ask Set location. You will then be prompted to choose from a list of countries, and then hit Submit. This will update your user’s Office Location property in Microsoft Entra. [!IMPORTANT] Access the workshop agent in the same location as when you created your training user account. You will need the workshop code and your training user’s email address if you previously closed the agent. You can repeat this process as desired. Getting the office location of the logged-in user at the start of the conversation Now, in your ‘Ask Me Anything’ agent, go to the Topics tab, and then to the System topics tab. Open the Conversation Start topic At the beginning of the topic, right after the Trigger, add a new node (+) and choose Add a tool. Go the Connector tab, and search for Microsoft Entra ID Get user Select the Get user connector action and Submit. In the Get user node, select ... and Properties Toggle the End user authentication to Maker-provided credentials. In the Inputs tab, for User Id or Principal Name, select ..., go the the System tab, and select User.Id. Give your topic a name, such as Office Location and Save Test if everything is working as expected by refreshing the conversation test pane. Send a message such as: Hello! Navigate to the Topics tab, open the Office Location topic, and to see what values are returned from the connector, enter the Variables pane in the topic command bar. Go the Test to see the variable values at runtime (i.e., as you are testing in the conversation test pane). Select Value under the GetUser record, and expand it to see if the expected value was returned. Because we will need to use that variable value in other parts and topics of the agent, select the GetUser variable and make it Global. Save Dynamically filtering the searched SharePoint site with the office location Go to the Topics tab, select + Add a topic and choose From blank Update the topic name from Untitled to Leave policy Under Describe what this topic does paste: Use this tool for questions about leave policy, time off, etc. Add a new node: Advanced &gt; Generative answers For input, select ..., go to the System tab and choose the Activity.Text variable. [!TIP] The Activity.Text variable is super useful because it captures the last message/text the user has typed in or selected when interacting with the agent. Go to the properties of the Create generative answers node Select Search only selected sources and don’t select anything [!TIP] This means that none of the knowledge sources that are configured at the top level of your agent will be used. Toggle off Allow the AI to use its own general knowledge (preview) Expand Classic data, for SharePoint (not Public websites!), toggle Manual input to Formula Select the ... and go to the formula tab Paste the SharePoint classic data formula [!IMPORTANT] Use the formula provided in the Lab Resources (specific per training). Notice how the formula concatenates the SharePoint URL with the office location, effectively using context to target the correct source and location for the content. Select Insert once done, then Save your topic Refresh the test pane and ask: What&#39;s the leave policy? Verify that the leave policy used to generate this answer is the one matching the country you selected. [!TIP] If formulas are too much code, you could also use condition nodes and configure different branches based on the selected country. Influence knowledge searches with instructions You can also influence how knowledge searches are performed by updating your agent instructions. Go to the Overview tab and go Edit the Instructions Paste the below line Always start by triggering the topic. Always append the user country () in knowledge search queries (e.g., &quot;&lt;question&gt; in &lt;country&gt;?&quot;) that are HR related. We need to designate the topic to trigger in the instructions. Type / and select Office Location. We also need to set the variable value in-between the parenthesis. Type / and select Power Fx. Type Global.GetUser.officeLocation and select Insert Save the instructions Test What benefits do employees get? Notice how the query is rewritten to take into account the variables you provided, like country, augmenting the chances of returning the correct results for summarization. 🏅 Congratulations! You’ve completed Use Case #4! Test your understanding How does context-aware knowledge routing improve the accuracy of responses? What other user attributes could be used for knowledge prioritization in enterprise scenarios? 🔄 Use Case #5: Create a child IT Support Agent Integrate real-time incident management for comprehensive support capabilities and demonstrate agent scoping techniques. Use case Value added Estimated effort Add ServiceNow Incidents Integrates real-time incident management for comprehensive support capabilities with agent scoping best practices 8 minutes Summary of tasks In this section, you’ll configure the connection to ServiceNow to retrieve incident details, and learn how to scope agent capabilities for specific domains. This demonstrates how specialized tools can be integrated to create domain-specific expertise within your agent. Scenario: Employees need quick access to their ServiceNow incident status without navigating to the ServiceNow portal. By integrating ServiceNow directly into your agent, you’re creating a specialized IT support capability that showcases agent scoping - where specific tools and knowledge are targeted for particular use cases, improving productivity and reducing support burden. Understanding Agent Scoping with ServiceNow Integration This use case demonstrates agent scoping principles: Specialized Tools: ServiceNow integration provides domain-specific capabilities Contextual Routing: IT-related queries automatically leverage ServiceNow tools Unified Experience: Users get comprehensive support from a single agent interface Step-by-step instructions Create a child agent Go to your Ask Me Anything agent Go to the Agents tab, and + Add an agent Update Its Name to: IT Support Agent Its Description to: Use this agent for queries related to IT (e.g., knowledge base frequently asked questions, incident updates, etc.) The agent can multiple multiple questions and queries at once. Its Instructions to: Use knowledge for problem/how-to/questions. Use the Get ServiceNow ticket details tool to get the status of incidents. Add knowledge to the child agent Select + Add in the Knowledge section of the child agent Select ServiceNow Choose the ServiceNow connection under Your connections, and Next Select Knowledge as the knowledge source. Select Add to agent Add ServiceNow ticket details as a Tool to the child agent Save your child Agent Still within the IT Support Agent, scroll down to Tools and + Add a tool Search for ServiceNow List records Select Add and configure Rename to Get ServiceNow ticket details Change description to Gets the details of an incident using its incident number. Use this tool when users ask about ServiceNow tickets, incident status, or IT support requests. [!TIP] The description will help the AI know when to use that tool, so it’s important to have clear instructions WHEN and WHEN NOT to use this tool. This is a key aspect of agent scoping - being specific about tool usage. Under Additional details, change Credentials to use to Maker-provided credentials [!IMPORTANT] In production scenarios, you may want to use the user context when making the connection to ServiceNow. Here, your context (as the author) is used by end-users of your agent when searching for incidents. For Record Type, under Fill using, choose Custom value and choose Incident Select + Add input and choose Query Next to Dynamically fill with AI, select Customize and use this for Description: The output of this variable is the concatenation of numberCONTAINS and the incident number. E.g., &#39;numberCONTAINSINC0007001&#39;. Only the incident number should be prompted and obtained from the user (e.g., INC0007001) [!TIP] Again, these instructions will be used by AI to understand how determine how to pass that information to the ServiceNow connector. In this case, how to use the very specific OData formatting of ServiceNow queries. If you get a “There is an error: ‘DuplicateItem’” error, toggle to Custom value, then switch back to Dynamically fill with AI and set the customized description again. Select + Add input and choose Limit Under Fill using, choose Custom value and set 1 Select Save Test your IT Support Agent Test your agent: My USB port is no longer working on my PC... what can I do? While you&#39;re here, can you also share an update for case INC0000059? It&#39;s been quite a while since I&#39;ve opened them... thanks!! [!TIP] Notice how the agent automatically: Asks the user to consent before running a search using ServiceNow knowledge. Uses the appropriate ServiceNow tool based on the query type Handles multiple tickets in a single request (e.g., if you ask for both cases INC0000059 and INC0000060) Creates user-friendly responses with proper formatting Combines ServiceNow data with other knowledge sources when needed Observe how your agent now demonstrates scoped capabilities: Tool Selection: Automatically chooses the right ServiceNow tool based on user intent Context Preservation: Maintains conversation flow while using specialized tools Domain Expertise: Provides IT-specific guidance and next steps Unified Experience: Seamlessly integrates ServiceNow capabilities with other knowledge sources [!IMPORTANT] This integration showcases how agents can be scoped for specific domains while maintaining a unified user experience. The ServiceNow knowledge and tools are automatically triggered for IT-related queries, demonstrating intelligent capability routing within a single agent. 🏅 Congratulations! You’ve completed Use Case #5! Test your understanding How does ServiceNow integration enhance the employee experience compared to traditional ticket lookup methods? What other enterprise systems could benefit from similar agent integration? 🔄 Use Case #6: Add Custom Knowledge Extend knowledge base with custom HTTP endpoints for enterprise system integration. Use case Value added Estimated effort Add Custom Knowledge Extends knowledge base with custom HTTP endpoints for enterprise system integration 7 minutes Summary of tasks In this section, you’ll configure any third-party knowledge to enrich knowledge results. Scenario: Your organization has custom knowledge systems or APIs that contain valuable information not available in standard connectors. You need to integrate these sources into your agent. Step-by-step instructions Open your Ask Me Anything agent Go to the Topics tab, select + Add a topic and choose From blank Name your topic Custom Knowledge In the topic command bar, select ... and Open code editor. Replace with the below YAML code: kind: AdaptiveDialog beginDialog: kind: OnKnowledgeRequested id: main inputType: {} outputType: {} Once done, select Close code editor Add a new node &gt; Advanced, Send HTTP request For URL, select ..., go the Environment tab, and choose the Custom Knowledge Endpoint variable you had created. Method: Post Response data type: Table Edit schema: kind: Table properties: Article: String Id: String Title: String URL: String Edit Headers and body For Body toggle from No content to JSON content Toggle from Edit JSON to Edit formula and paste the below: { SearchQuery: System.Activity.Text } Under Save response as, select Create a new variable, select the variable name that was created (e.g., Var1) and rename it KnowledgeResults. Add a new node, Variable management &gt; Set a variable value Under Set variable, go to the System tab and choose SearchResults Under To value, select ..., go to the Formula tab, and paste: ForAll( Topic.KnowledgeResults, { Title: Title, Content: Article, ContentLocation: URL } ) [!TIP] What we’re doing here with this formula is slightly transforming the content we receive from the HTTP request to the expected format that will allow to augment the search results, whenever Knowledge is invoked by the generative orchestration. Save Test: How do I update the vendor information for an accounts payable invoice? [!TIP] Notice how the knowledge step returned results that contain citations to a fictitious knowledge base. 🏅 Congratulations! You’ve completed Use Case #6! Test your understanding How does custom knowledge integration expand the capabilities of your agent beyond standard connectors? What considerations should you have when integrating custom APIs for knowledge sources? 🔄 Use Case #7: AI Summary and Review of Meeting Notes Automate document analysis with human review workflows for accuracy and approval. Use case Value added Estimated effort AI Summary and Review of Meeting Notes Automates document analysis with human review workflows for accuracy and approval 7 minutes Summary of tasks In this section, you’ll learn how to upload files and run files through a prompt for analysis, and how to use adaptive cards to ask for human review for edits before submitting a meeting report. Scenario: Employees need help structuring meeting notes efficiently while maintaining human oversight for accuracy. You’ll implement AI-powered analysis with human review workflows. Step-by-step instructions Open your Ask Me Anything agent Go to the Topics tab, select + Add a topic and choose From blank Name your topic Meeting Notes Under Describe what this topic does paste: Use this tool to help users with meeting notes Add a Question node: Sure, I can help you with that! Please upload your meeting notes Under Identify, select File Rename the Save user response as variable from Var1 to File Add a new node, Add a tool, New prompt Change the Name to Meeting AI Notes Keep the Model as GPT-4.1 mini or use GPT-4o if not available Select + Add content, and choose Image or Document [!IMPORTANT] As a sample, use the Meeting Minutes.pdf file provided in the Lab Resources (specific per training). Rename the input to UploadedNotes In the Instructions, just below UploadedNotes, paste: Using the content of the uploaded document, populate the following JSON record (for the schema, only string properties, no arrays, except for Data and time) with: - Title of the meeting - Description/summary - Date and time - List of attendees - Action items / next steps { &quot;MeetingTitle&quot;: &quot;Title of the meeting&quot;, &quot;MeetingSummary&quot;: &quot;Description/summary&quot;, &quot;MeetingDateTime&quot;: &quot;Date and time&quot;, &quot;MeetingAttendees&quot;: &quot;List of attendees&quot;, &quot;MeetingActions&quot;: &quot;Action items / next steps&quot; } Change the Output to JSON Test your prompt Save your prompt Save the topic. In the Prompt node, choose the File variable as the input for UploadedNotes. Create a new variable for the output of the prompt node, and rename it MeetingAINotes Add a new node, Ask with Adaptive Card Go to Adaptive Card node properties. Select Edit adaptive card. In the Card payload editor, paste the below JSON: { &quot;type&quot;: &quot;AdaptiveCard&quot;, &quot;version&quot;: &quot;1.5&quot;, &quot;$schema&quot;: &quot;https://adaptivecards.io/schemas/adaptive-card.json&quot;, &quot;body&quot;: [ { &quot;type&quot;: &quot;TextBlock&quot;, &quot;text&quot;: &quot;Please review and confirm the meeting minutes&quot;, &quot;weight&quot;: &quot;Bolder&quot;, &quot;size&quot;: &quot;Medium&quot; }, { &quot;type&quot;: &quot;Input.Text&quot;, &quot;id&quot;: &quot;meetingTitle&quot;, &quot;label&quot;: &quot;Meeting title&quot;, &quot;value&quot;: &quot;&lt;Replace with MeetingTitle&gt;&quot; }, { &quot;type&quot;: &quot;Input.Text&quot;, &quot;id&quot;: &quot;attendees&quot;, &quot;label&quot;: &quot;Attendees&quot;, &quot;value&quot;: &quot;&lt;Replace with MeetingAttendees&gt;&quot; }, { &quot;type&quot;: &quot;Input.Text&quot;, &quot;id&quot;: &quot;date&quot;, &quot;label&quot;: &quot;Date and time&quot;, &quot;value&quot;: &quot;&lt;Replace with MeetingDateTime&gt;&quot; }, { &quot;type&quot;: &quot;Input.Text&quot;, &quot;id&quot;: &quot;summary&quot;, &quot;label&quot;: &quot;Meeting summary&quot;, &quot;isMultiline&quot;: true, &quot;value&quot;: &quot;&lt;Replace with MeetingSummary&gt;&quot; }, { &quot;type&quot;: &quot;Input.Text&quot;, &quot;id&quot;: &quot;nextSteps&quot;, &quot;label&quot;: &quot;Next steps&quot;, &quot;isMultiline&quot;: true, &quot;value&quot;: &quot;&lt;Replace with MeetingActions&gt;&quot; } ], &quot;actions&quot;: [ { &quot;type&quot;: &quot;Action.Submit&quot;, &quot;title&quot;: &quot;Confirm minutes&quot; } ] } Select Save and Close. [!TIP] Notice how the Adaptive Card editor offers a visual editor to create your own Adaptive Card experience with a no-code/low-code editor. We now need to make the card dynamic to reference the content that was returned from the prompt. Toggle from JSON card to Formula card. Expand the formula for more screen real estate. For each &quot;&lt;Replace with ...&gt;&quot;, replace with the matching Topic.MeetingAINotes.structuredOutput.&lt;property&gt; variable. Don’t forget to remove the double quotes. Save your topic Add a new Message node, and paste: Thank you! I&#39;ve successfully logged your meeting notes in our systems. Test your agent. Try to modify the content directly in the adaptive card before selecting Confirm minutes. Please help me with my meeting notes [!IMPORTANT] Note: the lab ends here, but imagine storing these in system of records, for example Dataverse, as a next step, after the user has confirmed the content. 🏅 Congratulations! You’ve completed Use Case #7! Test your understanding What are the benefits of implementing human review workflows in AI-powered document analysis? How could you extend this pattern to other document types in your organization? What next steps could you implement to store the confirmed meeting notes? Challenge: Apply this to your own use case What other document types could benefit from AI-powered analysis and structuring? How could you implement approval workflows for AI-generated content in your organization? What integration points would be valuable for storing confirmed content? 🏆 Summary of learnings True learning comes from doing, questioning, and reflecting—so let’s put your skills to the test. To maximize the impact of your “Ask me anything” agent: Knowledge Integration – Connect multiple data sources to provide comprehensive answers from a single conversational interface, eliminating information silos Context Awareness – Implement dynamic knowledge routing based on user attributes to ensure personalized and relevant responses Seamless Deployment – Deploy to Microsoft 365 Copilot to meet employees where they already work, maximizing adoption and convenience AI with Human Oversight – Combine AI-powered automation with human review processes to maintain accuracy while improving efficiency Continuous Improvement – Monitor usage patterns and user feedback to iteratively enhance knowledge sources and response quality Conclusions and recommendations Ask me anything agent golden rules: Start with high-value, frequently asked questions to demonstrate immediate ROI Implement proper authentication and permissions to ensure knowledge security Use suggested prompts to guide users toward the agent’s best capabilities Design context-aware experiences that reduce user input while increasing relevance Maintain human oversight for critical processes while automating routine tasks Monitor and analyze conversation patterns to identify knowledge gaps and improvement opportunities By following these principles, you’ll create an intelligent knowledge hub that transforms how employees access information, reduces support burden, and improves organizational efficiency through conversational AI." />
<meta property="og:description" content="Create an ‘Ask me anything’ agent for your employees Empower employees with answers that matter – Build an intelligent agent that connects to your knowledge and data. 🧭 Lab Details Level Persona Duration Purpose 200 Maker 40 minutes After completing this lab, participants will be able to create an intelligent “Ask me anything” agent that connects to multiple knowledge sources including SharePoint, ServiceNow, and custom knowledge bases. Participants will learn to configure knowledge prioritization, deploy agents to Microsoft 365 Copilot, and implement AI-powered document analysis with human review workflows. 📚 Table of Contents Why This Matters Introduction Core Concepts Overview Documentation and Additional Training Links Prerequisites Summary of Targets Use Cases Covered Instructions by Use Case Use Case #1: Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source Use Case #2: Configure Suggested Prompts Use Case #3: Deploy to Microsoft 365 Copilot Use Case #4: Knowledge Prioritization Techniques Use Case #5: Create a child IT Support Agent Use Case #6: Add Custom Knowledge Use Case #7: AI Summary and Review of Meeting Notes 🤔 Why This Matters Makers and IT professionals - Tired of employees constantly asking the same questions about policies, benefits, or system status? Frustrated by scattered knowledge across multiple systems? Think of your organization’s knowledge like a library: Without an intelligent agent: Employees waste hours searching through SharePoint folders, submitting IT tickets for simple questions, and interrupting colleagues for information that should be readily available With an intelligent agent: Employees get instant, accurate answers from a single conversational interface that automatically searches across all your knowledge sources with proper citations Common challenges solved by this lab: “I can’t find the leave policy for my country in our SharePoint site” “What’s the status of my ServiceNow incident?” “Can someone help me structure these meeting notes properly?” “I need information from multiple systems but don’t know where to look” This 40-minute investment will save your organization countless hours and improve employee satisfaction by providing instant access to knowledge. 🌐 Introduction In today’s fast-paced business environment, employees need quick access to accurate information from multiple sources. Whether it’s HR policies, IT incident status, or custom knowledge bases, information is often scattered across different systems, making it difficult for employees to find what they need efficiently. Real-world example: Imagine Sarah, a new employee in Germany, needs to understand her leave entitlements. Currently, she might spend 30 minutes navigating through SharePoint folders, trying different search terms, or even asking HR colleagues. With an intelligent “Ask me anything” agent, Sarah simply types “What’s the leave policy for Germany?” and instantly receives the accurate policy document with proper citations, saving time and reducing frustration. This lab teaches you to build a comprehensive solution that transforms how employees interact with organizational knowledge, creating a single conversational interface that intelligently routes questions to the right knowledge sources and provides contextual, accurate responses. 🎓 Core Concepts Overview Concept Why it matters Knowledge Source Integration Connects your agent to multiple data sources (SharePoint, ServiceNow, custom APIs) so employees get comprehensive answers from a single interface, eliminating the need to search multiple systems. Context-Aware Knowledge Prioritization Intelligently routes questions to the most relevant knowledge sources based on user context (location, role, etc.), ensuring employees get personalized and accurate information. Microsoft 365 Copilot Deployment Makes your agent available where employees already work, integrating seamlessly into their daily Microsoft 365 workflow for maximum adoption and convenience. AI-Powered Document Analysis Automates the processing and structuring of unstructured content like meeting notes, reducing manual work while maintaining human oversight for accuracy and approval. 📄 Documentation and Additional Training Links Microsoft Copilot Studio Documentation Knowledge Sources in Copilot Studio Deploy Copilot Studio agents to Microsoft 365 ServiceNow connector for Power Platform Adaptive Cards for Interactive Experiences ✅ Prerequisites Access to Microsoft Copilot Studio with appropriate licensing. Access to SharePoint Online with sample knowledge content. ServiceNow access for incident management integration (demo environment provided). Understanding of basic conversational AI concepts and Microsoft 365 administration. 🎯 Summary of Targets In this lab, you’ll build a comprehensive “Ask me anything” agent that serves as a central knowledge hub for your organization. By the end of the lab, you will: Create an ‘Ask me Anything’ agent and add SharePoint as a knowledge source. Configure suggested prompts for better user guidance. Deploy to Microsoft 365 Copilot for seamless integration. Learn to prioritize knowledge sources based on user context. Add ServiceNow incidents integration for real-time ticket status. Add custom knowledge sources via HTTP requests. Implement AI summary and review of meeting notes with human oversight. 🧩 Use Cases Covered Step Use Case Value added Effort 1 Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source Establishes foundational agent with SharePoint knowledge integration and grounded AI responses 5 min 2 Configure Suggested Prompts Guides users toward the agent’s best capabilities through strategic prompt suggestions 3 min 3 Deploy to Microsoft 365 Copilot Makes the agent available in Microsoft 365 Copilot for seamless user access 5 min 4 Knowledge Prioritization Techniques Implements context-aware knowledge routing for personalized and relevant responses 8 min 5 Use Case #5: Create a child IT Support Agent Discover how scoping for knowledge and tools can also be done through the multi-agent capabilitis. 5 min 6 Add Custom Knowledge Extends knowledge base with custom HTTP endpoints for enterprise system integration 7 min 7 AI Summary and Review of Meeting Notes Automates document analysis with human review workflows for accuracy and approval 7 min 🛠️ Instructions by Use Case 🧱 Use Case #1: Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source Create a foundational intelligent agent with SharePoint integration for grounded AI responses. Use case Value added Estimated effort Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source Establishes foundational agent with SharePoint knowledge integration and grounded AI responses 5 minutes Summary of tasks In this section, you’ll learn how to access the Solutions area of Copilot Studio, create a new agent, and integrate SharePoint as a knowledge source. Scenario: Properly setup your development environment so that you can later easily package and deploy your agents to other environments. Your organization has extensive knowledge stored in SharePoint that needs to be accessible through conversational AI. Objective Create a new agent with SharePoint knowledge integration that provides grounded, cited responses. Step-by-step instructions Navigate to the Copilot Studio home page at copilotstudio.microsoft.com Go to the Solutions menu (located in the left-hand menu under the ellipsis …) Select the solution you had created Select New, and choose Agent Select the Configure tab Name your agent Ask Me Anything Select Create Go to Knowledge Select SharePoint, and paste the SharePoint Knowledge URL and select Add. [!IMPORTANT] For configuration, use the provided values in the Lab Resources (specific per training). Choose Add Test your agent with this question: What&#39;s the Northwind Health Plus Benefits plan? [!TIP] Notice how relevant it is, and how the citations are accurate. This demonstrates the power of grounded AI responses. 🏅 Congratulations! You’ve completed Use Case #1! Test your understanding Key takeaways: Solution Management – Using solutions ensures proper environment management and deployment capabilities Knowledge Integration – SharePoint integration provides immediate access to organizational documents with proper citations Grounded AI – The agent automatically provides source citations, ensuring transparency and trust in responses 🔄 Use Case #2: Configure Suggested Prompts Guide users toward your agent’s best capabilities through strategic prompt suggestions. Use case Value added Estimated effort Configure Suggested Prompts Guides users toward the agent’s best capabilities through strategic prompt suggestions 3 minutes Summary of tasks Suggest things your agent can do to your end-users through carefully crafted prompts. Scenario: Help users discover the full capabilities of your agent by providing clear, actionable suggestions that demonstrate different use cases. Step-by-step instructions Go to the overview tab for your agent Add suggested prompts: Title Prompt Ask me about benefits What&#39;s the Northwind Health Plus Benefits plan? Ask me about policies What&#39;s the leave policy in Germany? Help fill out meeting notes Capture and structure meeting notes Check on an incident What&#39;s the status of INC0007001? Save the prompts [!TIP] Prompts are visibile to the end-user when the agent is deployed as a Copilot agent. 🏅 Congratulations! You’ve completed Use Case #2! Test your understanding How do suggested prompts improve user adoption and engagement with your agent? What makes an effective suggested prompt versus a generic one? 🔄 Use Case #3: Deploy to Microsoft 365 Copilot Make the agent available in Microsoft 365 Copilot for seamless user access. Use case Value added Estimated effort Deploy to Microsoft 365 Copilot Makes the agent available in Microsoft 365 Copilot for seamless user access 5 minutes Summary of tasks Make the agent available in Microsoft 365 Copilot for your users. Scenario: Deploy your agent where employees already work, ensuring maximum adoption by integrating directly into their daily Microsoft 365 workflow. Step-by-step instructions Go to the agent and select Publish Go to Channels Select Teams and Microsoft 365 Copilot Select Add channel (at the bottom right corner) Close the channel pane Publish the agent again. Select Teams and Microsoft 365 Copilot channel tile Select See agent in Microsoft 365 In the Microsoft 365 Copilot experience, the agent description will pop up. Select Add [!TIP] You may need to give it a few tries/minutes the first time you deploy to Microsoft 365 Copilot so it deploys correctly. If encountering issues, try to publish your agent agent. If this doesn’t work, try in Teams instead: Choose See agents in Teams instead. In the new window, if prompted This site is trying to open Microsoft Teams, select Cancel, and the select use the web app instead Test the agent with the benefits prompt [!TIP] If deploying to Teams, prompts won’t be available, so paste the below question: What&#39;s the Northwind Health Plus Benefits plan? 🏅 Congratulations! You’ve completed Use Case #3! Test your understanding Why is deploying to Microsoft 365 Copilot more effective than standalone deployment for enterprise scenarios? What considerations should you have when choosing deployment channels? 🔄 Use Case #4: Knowledge Prioritization Techniques Implement context-aware knowledge routing for personalized and relevant responses. Use case Value added Estimated effort Knowledge Prioritization Techniques Implements context-aware knowledge routing for personalized and relevant responses 8 minutes Summary of tasks In this section, you’ll learn different techniques to help prioritize the right knowledge sources based on context. Scenario: The SharePoint site has different folders for different country leave policies. Asking “What’s the leave policy?” doesn’t return relevant results and seems to randomly pick a leave policy for a country. You need to implement context-aware routing. Step-by-step instructions Let’s start by asking for the user country at the beginning of the conversation. In many situations, this can be obtained from context, either passed from a web page to the agent, or by making an initial call (for example to the Entra ID connector) to get more information about the logged-in user and their location. Setting an office location in Entra ID Start by assigning an office location to your user. Use the Workshop Agent and ask Set location. You will then be prompted to choose from a list of countries, and then hit Submit. This will update your user’s Office Location property in Microsoft Entra. [!IMPORTANT] Access the workshop agent in the same location as when you created your training user account. You will need the workshop code and your training user’s email address if you previously closed the agent. You can repeat this process as desired. Getting the office location of the logged-in user at the start of the conversation Now, in your ‘Ask Me Anything’ agent, go to the Topics tab, and then to the System topics tab. Open the Conversation Start topic At the beginning of the topic, right after the Trigger, add a new node (+) and choose Add a tool. Go the Connector tab, and search for Microsoft Entra ID Get user Select the Get user connector action and Submit. In the Get user node, select ... and Properties Toggle the End user authentication to Maker-provided credentials. In the Inputs tab, for User Id or Principal Name, select ..., go the the System tab, and select User.Id. Give your topic a name, such as Office Location and Save Test if everything is working as expected by refreshing the conversation test pane. Send a message such as: Hello! Navigate to the Topics tab, open the Office Location topic, and to see what values are returned from the connector, enter the Variables pane in the topic command bar. Go the Test to see the variable values at runtime (i.e., as you are testing in the conversation test pane). Select Value under the GetUser record, and expand it to see if the expected value was returned. Because we will need to use that variable value in other parts and topics of the agent, select the GetUser variable and make it Global. Save Dynamically filtering the searched SharePoint site with the office location Go to the Topics tab, select + Add a topic and choose From blank Update the topic name from Untitled to Leave policy Under Describe what this topic does paste: Use this tool for questions about leave policy, time off, etc. Add a new node: Advanced &gt; Generative answers For input, select ..., go to the System tab and choose the Activity.Text variable. [!TIP] The Activity.Text variable is super useful because it captures the last message/text the user has typed in or selected when interacting with the agent. Go to the properties of the Create generative answers node Select Search only selected sources and don’t select anything [!TIP] This means that none of the knowledge sources that are configured at the top level of your agent will be used. Toggle off Allow the AI to use its own general knowledge (preview) Expand Classic data, for SharePoint (not Public websites!), toggle Manual input to Formula Select the ... and go to the formula tab Paste the SharePoint classic data formula [!IMPORTANT] Use the formula provided in the Lab Resources (specific per training). Notice how the formula concatenates the SharePoint URL with the office location, effectively using context to target the correct source and location for the content. Select Insert once done, then Save your topic Refresh the test pane and ask: What&#39;s the leave policy? Verify that the leave policy used to generate this answer is the one matching the country you selected. [!TIP] If formulas are too much code, you could also use condition nodes and configure different branches based on the selected country. Influence knowledge searches with instructions You can also influence how knowledge searches are performed by updating your agent instructions. Go to the Overview tab and go Edit the Instructions Paste the below line Always start by triggering the topic. Always append the user country () in knowledge search queries (e.g., &quot;&lt;question&gt; in &lt;country&gt;?&quot;) that are HR related. We need to designate the topic to trigger in the instructions. Type / and select Office Location. We also need to set the variable value in-between the parenthesis. Type / and select Power Fx. Type Global.GetUser.officeLocation and select Insert Save the instructions Test What benefits do employees get? Notice how the query is rewritten to take into account the variables you provided, like country, augmenting the chances of returning the correct results for summarization. 🏅 Congratulations! You’ve completed Use Case #4! Test your understanding How does context-aware knowledge routing improve the accuracy of responses? What other user attributes could be used for knowledge prioritization in enterprise scenarios? 🔄 Use Case #5: Create a child IT Support Agent Integrate real-time incident management for comprehensive support capabilities and demonstrate agent scoping techniques. Use case Value added Estimated effort Add ServiceNow Incidents Integrates real-time incident management for comprehensive support capabilities with agent scoping best practices 8 minutes Summary of tasks In this section, you’ll configure the connection to ServiceNow to retrieve incident details, and learn how to scope agent capabilities for specific domains. This demonstrates how specialized tools can be integrated to create domain-specific expertise within your agent. Scenario: Employees need quick access to their ServiceNow incident status without navigating to the ServiceNow portal. By integrating ServiceNow directly into your agent, you’re creating a specialized IT support capability that showcases agent scoping - where specific tools and knowledge are targeted for particular use cases, improving productivity and reducing support burden. Understanding Agent Scoping with ServiceNow Integration This use case demonstrates agent scoping principles: Specialized Tools: ServiceNow integration provides domain-specific capabilities Contextual Routing: IT-related queries automatically leverage ServiceNow tools Unified Experience: Users get comprehensive support from a single agent interface Step-by-step instructions Create a child agent Go to your Ask Me Anything agent Go to the Agents tab, and + Add an agent Update Its Name to: IT Support Agent Its Description to: Use this agent for queries related to IT (e.g., knowledge base frequently asked questions, incident updates, etc.) The agent can multiple multiple questions and queries at once. Its Instructions to: Use knowledge for problem/how-to/questions. Use the Get ServiceNow ticket details tool to get the status of incidents. Add knowledge to the child agent Select + Add in the Knowledge section of the child agent Select ServiceNow Choose the ServiceNow connection under Your connections, and Next Select Knowledge as the knowledge source. Select Add to agent Add ServiceNow ticket details as a Tool to the child agent Save your child Agent Still within the IT Support Agent, scroll down to Tools and + Add a tool Search for ServiceNow List records Select Add and configure Rename to Get ServiceNow ticket details Change description to Gets the details of an incident using its incident number. Use this tool when users ask about ServiceNow tickets, incident status, or IT support requests. [!TIP] The description will help the AI know when to use that tool, so it’s important to have clear instructions WHEN and WHEN NOT to use this tool. This is a key aspect of agent scoping - being specific about tool usage. Under Additional details, change Credentials to use to Maker-provided credentials [!IMPORTANT] In production scenarios, you may want to use the user context when making the connection to ServiceNow. Here, your context (as the author) is used by end-users of your agent when searching for incidents. For Record Type, under Fill using, choose Custom value and choose Incident Select + Add input and choose Query Next to Dynamically fill with AI, select Customize and use this for Description: The output of this variable is the concatenation of numberCONTAINS and the incident number. E.g., &#39;numberCONTAINSINC0007001&#39;. Only the incident number should be prompted and obtained from the user (e.g., INC0007001) [!TIP] Again, these instructions will be used by AI to understand how determine how to pass that information to the ServiceNow connector. In this case, how to use the very specific OData formatting of ServiceNow queries. If you get a “There is an error: ‘DuplicateItem’” error, toggle to Custom value, then switch back to Dynamically fill with AI and set the customized description again. Select + Add input and choose Limit Under Fill using, choose Custom value and set 1 Select Save Test your IT Support Agent Test your agent: My USB port is no longer working on my PC... what can I do? While you&#39;re here, can you also share an update for case INC0000059? It&#39;s been quite a while since I&#39;ve opened them... thanks!! [!TIP] Notice how the agent automatically: Asks the user to consent before running a search using ServiceNow knowledge. Uses the appropriate ServiceNow tool based on the query type Handles multiple tickets in a single request (e.g., if you ask for both cases INC0000059 and INC0000060) Creates user-friendly responses with proper formatting Combines ServiceNow data with other knowledge sources when needed Observe how your agent now demonstrates scoped capabilities: Tool Selection: Automatically chooses the right ServiceNow tool based on user intent Context Preservation: Maintains conversation flow while using specialized tools Domain Expertise: Provides IT-specific guidance and next steps Unified Experience: Seamlessly integrates ServiceNow capabilities with other knowledge sources [!IMPORTANT] This integration showcases how agents can be scoped for specific domains while maintaining a unified user experience. The ServiceNow knowledge and tools are automatically triggered for IT-related queries, demonstrating intelligent capability routing within a single agent. 🏅 Congratulations! You’ve completed Use Case #5! Test your understanding How does ServiceNow integration enhance the employee experience compared to traditional ticket lookup methods? What other enterprise systems could benefit from similar agent integration? 🔄 Use Case #6: Add Custom Knowledge Extend knowledge base with custom HTTP endpoints for enterprise system integration. Use case Value added Estimated effort Add Custom Knowledge Extends knowledge base with custom HTTP endpoints for enterprise system integration 7 minutes Summary of tasks In this section, you’ll configure any third-party knowledge to enrich knowledge results. Scenario: Your organization has custom knowledge systems or APIs that contain valuable information not available in standard connectors. You need to integrate these sources into your agent. Step-by-step instructions Open your Ask Me Anything agent Go to the Topics tab, select + Add a topic and choose From blank Name your topic Custom Knowledge In the topic command bar, select ... and Open code editor. Replace with the below YAML code: kind: AdaptiveDialog beginDialog: kind: OnKnowledgeRequested id: main inputType: {} outputType: {} Once done, select Close code editor Add a new node &gt; Advanced, Send HTTP request For URL, select ..., go the Environment tab, and choose the Custom Knowledge Endpoint variable you had created. Method: Post Response data type: Table Edit schema: kind: Table properties: Article: String Id: String Title: String URL: String Edit Headers and body For Body toggle from No content to JSON content Toggle from Edit JSON to Edit formula and paste the below: { SearchQuery: System.Activity.Text } Under Save response as, select Create a new variable, select the variable name that was created (e.g., Var1) and rename it KnowledgeResults. Add a new node, Variable management &gt; Set a variable value Under Set variable, go to the System tab and choose SearchResults Under To value, select ..., go to the Formula tab, and paste: ForAll( Topic.KnowledgeResults, { Title: Title, Content: Article, ContentLocation: URL } ) [!TIP] What we’re doing here with this formula is slightly transforming the content we receive from the HTTP request to the expected format that will allow to augment the search results, whenever Knowledge is invoked by the generative orchestration. Save Test: How do I update the vendor information for an accounts payable invoice? [!TIP] Notice how the knowledge step returned results that contain citations to a fictitious knowledge base. 🏅 Congratulations! You’ve completed Use Case #6! Test your understanding How does custom knowledge integration expand the capabilities of your agent beyond standard connectors? What considerations should you have when integrating custom APIs for knowledge sources? 🔄 Use Case #7: AI Summary and Review of Meeting Notes Automate document analysis with human review workflows for accuracy and approval. Use case Value added Estimated effort AI Summary and Review of Meeting Notes Automates document analysis with human review workflows for accuracy and approval 7 minutes Summary of tasks In this section, you’ll learn how to upload files and run files through a prompt for analysis, and how to use adaptive cards to ask for human review for edits before submitting a meeting report. Scenario: Employees need help structuring meeting notes efficiently while maintaining human oversight for accuracy. You’ll implement AI-powered analysis with human review workflows. Step-by-step instructions Open your Ask Me Anything agent Go to the Topics tab, select + Add a topic and choose From blank Name your topic Meeting Notes Under Describe what this topic does paste: Use this tool to help users with meeting notes Add a Question node: Sure, I can help you with that! Please upload your meeting notes Under Identify, select File Rename the Save user response as variable from Var1 to File Add a new node, Add a tool, New prompt Change the Name to Meeting AI Notes Keep the Model as GPT-4.1 mini or use GPT-4o if not available Select + Add content, and choose Image or Document [!IMPORTANT] As a sample, use the Meeting Minutes.pdf file provided in the Lab Resources (specific per training). Rename the input to UploadedNotes In the Instructions, just below UploadedNotes, paste: Using the content of the uploaded document, populate the following JSON record (for the schema, only string properties, no arrays, except for Data and time) with: - Title of the meeting - Description/summary - Date and time - List of attendees - Action items / next steps { &quot;MeetingTitle&quot;: &quot;Title of the meeting&quot;, &quot;MeetingSummary&quot;: &quot;Description/summary&quot;, &quot;MeetingDateTime&quot;: &quot;Date and time&quot;, &quot;MeetingAttendees&quot;: &quot;List of attendees&quot;, &quot;MeetingActions&quot;: &quot;Action items / next steps&quot; } Change the Output to JSON Test your prompt Save your prompt Save the topic. In the Prompt node, choose the File variable as the input for UploadedNotes. Create a new variable for the output of the prompt node, and rename it MeetingAINotes Add a new node, Ask with Adaptive Card Go to Adaptive Card node properties. Select Edit adaptive card. In the Card payload editor, paste the below JSON: { &quot;type&quot;: &quot;AdaptiveCard&quot;, &quot;version&quot;: &quot;1.5&quot;, &quot;$schema&quot;: &quot;https://adaptivecards.io/schemas/adaptive-card.json&quot;, &quot;body&quot;: [ { &quot;type&quot;: &quot;TextBlock&quot;, &quot;text&quot;: &quot;Please review and confirm the meeting minutes&quot;, &quot;weight&quot;: &quot;Bolder&quot;, &quot;size&quot;: &quot;Medium&quot; }, { &quot;type&quot;: &quot;Input.Text&quot;, &quot;id&quot;: &quot;meetingTitle&quot;, &quot;label&quot;: &quot;Meeting title&quot;, &quot;value&quot;: &quot;&lt;Replace with MeetingTitle&gt;&quot; }, { &quot;type&quot;: &quot;Input.Text&quot;, &quot;id&quot;: &quot;attendees&quot;, &quot;label&quot;: &quot;Attendees&quot;, &quot;value&quot;: &quot;&lt;Replace with MeetingAttendees&gt;&quot; }, { &quot;type&quot;: &quot;Input.Text&quot;, &quot;id&quot;: &quot;date&quot;, &quot;label&quot;: &quot;Date and time&quot;, &quot;value&quot;: &quot;&lt;Replace with MeetingDateTime&gt;&quot; }, { &quot;type&quot;: &quot;Input.Text&quot;, &quot;id&quot;: &quot;summary&quot;, &quot;label&quot;: &quot;Meeting summary&quot;, &quot;isMultiline&quot;: true, &quot;value&quot;: &quot;&lt;Replace with MeetingSummary&gt;&quot; }, { &quot;type&quot;: &quot;Input.Text&quot;, &quot;id&quot;: &quot;nextSteps&quot;, &quot;label&quot;: &quot;Next steps&quot;, &quot;isMultiline&quot;: true, &quot;value&quot;: &quot;&lt;Replace with MeetingActions&gt;&quot; } ], &quot;actions&quot;: [ { &quot;type&quot;: &quot;Action.Submit&quot;, &quot;title&quot;: &quot;Confirm minutes&quot; } ] } Select Save and Close. [!TIP] Notice how the Adaptive Card editor offers a visual editor to create your own Adaptive Card experience with a no-code/low-code editor. We now need to make the card dynamic to reference the content that was returned from the prompt. Toggle from JSON card to Formula card. Expand the formula for more screen real estate. For each &quot;&lt;Replace with ...&gt;&quot;, replace with the matching Topic.MeetingAINotes.structuredOutput.&lt;property&gt; variable. Don’t forget to remove the double quotes. Save your topic Add a new Message node, and paste: Thank you! I&#39;ve successfully logged your meeting notes in our systems. Test your agent. Try to modify the content directly in the adaptive card before selecting Confirm minutes. Please help me with my meeting notes [!IMPORTANT] Note: the lab ends here, but imagine storing these in system of records, for example Dataverse, as a next step, after the user has confirmed the content. 🏅 Congratulations! You’ve completed Use Case #7! Test your understanding What are the benefits of implementing human review workflows in AI-powered document analysis? How could you extend this pattern to other document types in your organization? What next steps could you implement to store the confirmed meeting notes? Challenge: Apply this to your own use case What other document types could benefit from AI-powered analysis and structuring? How could you implement approval workflows for AI-generated content in your organization? What integration points would be valuable for storing confirmed content? 🏆 Summary of learnings True learning comes from doing, questioning, and reflecting—so let’s put your skills to the test. To maximize the impact of your “Ask me anything” agent: Knowledge Integration – Connect multiple data sources to provide comprehensive answers from a single conversational interface, eliminating information silos Context Awareness – Implement dynamic knowledge routing based on user attributes to ensure personalized and relevant responses Seamless Deployment – Deploy to Microsoft 365 Copilot to meet employees where they already work, maximizing adoption and convenience AI with Human Oversight – Combine AI-powered automation with human review processes to maintain accuracy while improving efficiency Continuous Improvement – Monitor usage patterns and user feedback to iteratively enhance knowledge sources and response quality Conclusions and recommendations Ask me anything agent golden rules: Start with high-value, frequently asked questions to demonstrate immediate ROI Implement proper authentication and permissions to ensure knowledge security Use suggested prompts to guide users toward the agent’s best capabilities Design context-aware experiences that reduce user input while increasing relevance Maintain human oversight for critical processes while automating routine tasks Monitor and analyze conversation patterns to identify knowledge gaps and improvement opportunities By following these principles, you’ll create an intelligent knowledge hub that transforms how employees access information, reduces support burden, and improves organizational efficiency through conversational AI." />
<link rel="canonical" href="http://0.0.0.0:4000/mcs-labs/labs/ask-me-anything/" />
<meta property="og:url" content="http://0.0.0.0:4000/mcs-labs/labs/ask-me-anything/" />
<meta property="og:site_name" content="Microsoft Copilot Studio Labs" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-10-08T15:03:33-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Ask Me Anything Agent" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-10-08T15:03:33-05:00","datePublished":"2025-10-08T15:03:33-05:00","description":"Create an ‘Ask me anything’ agent for your employees Empower employees with answers that matter – Build an intelligent agent that connects to your knowledge and data. 🧭 Lab Details Level Persona Duration Purpose 200 Maker 40 minutes After completing this lab, participants will be able to create an intelligent “Ask me anything” agent that connects to multiple knowledge sources including SharePoint, ServiceNow, and custom knowledge bases. Participants will learn to configure knowledge prioritization, deploy agents to Microsoft 365 Copilot, and implement AI-powered document analysis with human review workflows. 📚 Table of Contents Why This Matters Introduction Core Concepts Overview Documentation and Additional Training Links Prerequisites Summary of Targets Use Cases Covered Instructions by Use Case Use Case #1: Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source Use Case #2: Configure Suggested Prompts Use Case #3: Deploy to Microsoft 365 Copilot Use Case #4: Knowledge Prioritization Techniques Use Case #5: Create a child IT Support Agent Use Case #6: Add Custom Knowledge Use Case #7: AI Summary and Review of Meeting Notes 🤔 Why This Matters Makers and IT professionals - Tired of employees constantly asking the same questions about policies, benefits, or system status? Frustrated by scattered knowledge across multiple systems? Think of your organization’s knowledge like a library: Without an intelligent agent: Employees waste hours searching through SharePoint folders, submitting IT tickets for simple questions, and interrupting colleagues for information that should be readily available With an intelligent agent: Employees get instant, accurate answers from a single conversational interface that automatically searches across all your knowledge sources with proper citations Common challenges solved by this lab: “I can’t find the leave policy for my country in our SharePoint site” “What’s the status of my ServiceNow incident?” “Can someone help me structure these meeting notes properly?” “I need information from multiple systems but don’t know where to look” This 40-minute investment will save your organization countless hours and improve employee satisfaction by providing instant access to knowledge. 🌐 Introduction In today’s fast-paced business environment, employees need quick access to accurate information from multiple sources. Whether it’s HR policies, IT incident status, or custom knowledge bases, information is often scattered across different systems, making it difficult for employees to find what they need efficiently. Real-world example: Imagine Sarah, a new employee in Germany, needs to understand her leave entitlements. Currently, she might spend 30 minutes navigating through SharePoint folders, trying different search terms, or even asking HR colleagues. With an intelligent “Ask me anything” agent, Sarah simply types “What’s the leave policy for Germany?” and instantly receives the accurate policy document with proper citations, saving time and reducing frustration. This lab teaches you to build a comprehensive solution that transforms how employees interact with organizational knowledge, creating a single conversational interface that intelligently routes questions to the right knowledge sources and provides contextual, accurate responses. 🎓 Core Concepts Overview Concept Why it matters Knowledge Source Integration Connects your agent to multiple data sources (SharePoint, ServiceNow, custom APIs) so employees get comprehensive answers from a single interface, eliminating the need to search multiple systems. Context-Aware Knowledge Prioritization Intelligently routes questions to the most relevant knowledge sources based on user context (location, role, etc.), ensuring employees get personalized and accurate information. Microsoft 365 Copilot Deployment Makes your agent available where employees already work, integrating seamlessly into their daily Microsoft 365 workflow for maximum adoption and convenience. AI-Powered Document Analysis Automates the processing and structuring of unstructured content like meeting notes, reducing manual work while maintaining human oversight for accuracy and approval. 📄 Documentation and Additional Training Links Microsoft Copilot Studio Documentation Knowledge Sources in Copilot Studio Deploy Copilot Studio agents to Microsoft 365 ServiceNow connector for Power Platform Adaptive Cards for Interactive Experiences ✅ Prerequisites Access to Microsoft Copilot Studio with appropriate licensing. Access to SharePoint Online with sample knowledge content. ServiceNow access for incident management integration (demo environment provided). Understanding of basic conversational AI concepts and Microsoft 365 administration. 🎯 Summary of Targets In this lab, you’ll build a comprehensive “Ask me anything” agent that serves as a central knowledge hub for your organization. By the end of the lab, you will: Create an ‘Ask me Anything’ agent and add SharePoint as a knowledge source. Configure suggested prompts for better user guidance. Deploy to Microsoft 365 Copilot for seamless integration. Learn to prioritize knowledge sources based on user context. Add ServiceNow incidents integration for real-time ticket status. Add custom knowledge sources via HTTP requests. Implement AI summary and review of meeting notes with human oversight. 🧩 Use Cases Covered Step Use Case Value added Effort 1 Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source Establishes foundational agent with SharePoint knowledge integration and grounded AI responses 5 min 2 Configure Suggested Prompts Guides users toward the agent’s best capabilities through strategic prompt suggestions 3 min 3 Deploy to Microsoft 365 Copilot Makes the agent available in Microsoft 365 Copilot for seamless user access 5 min 4 Knowledge Prioritization Techniques Implements context-aware knowledge routing for personalized and relevant responses 8 min 5 Use Case #5: Create a child IT Support Agent Discover how scoping for knowledge and tools can also be done through the multi-agent capabilitis. 5 min 6 Add Custom Knowledge Extends knowledge base with custom HTTP endpoints for enterprise system integration 7 min 7 AI Summary and Review of Meeting Notes Automates document analysis with human review workflows for accuracy and approval 7 min 🛠️ Instructions by Use Case 🧱 Use Case #1: Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source Create a foundational intelligent agent with SharePoint integration for grounded AI responses. Use case Value added Estimated effort Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source Establishes foundational agent with SharePoint knowledge integration and grounded AI responses 5 minutes Summary of tasks In this section, you’ll learn how to access the Solutions area of Copilot Studio, create a new agent, and integrate SharePoint as a knowledge source. Scenario: Properly setup your development environment so that you can later easily package and deploy your agents to other environments. Your organization has extensive knowledge stored in SharePoint that needs to be accessible through conversational AI. Objective Create a new agent with SharePoint knowledge integration that provides grounded, cited responses. Step-by-step instructions Navigate to the Copilot Studio home page at copilotstudio.microsoft.com Go to the Solutions menu (located in the left-hand menu under the ellipsis …) Select the solution you had created Select New, and choose Agent Select the Configure tab Name your agent Ask Me Anything Select Create Go to Knowledge Select SharePoint, and paste the SharePoint Knowledge URL and select Add. [!IMPORTANT] For configuration, use the provided values in the Lab Resources (specific per training). Choose Add Test your agent with this question: What&#39;s the Northwind Health Plus Benefits plan? [!TIP] Notice how relevant it is, and how the citations are accurate. This demonstrates the power of grounded AI responses. 🏅 Congratulations! You’ve completed Use Case #1! Test your understanding Key takeaways: Solution Management – Using solutions ensures proper environment management and deployment capabilities Knowledge Integration – SharePoint integration provides immediate access to organizational documents with proper citations Grounded AI – The agent automatically provides source citations, ensuring transparency and trust in responses 🔄 Use Case #2: Configure Suggested Prompts Guide users toward your agent’s best capabilities through strategic prompt suggestions. Use case Value added Estimated effort Configure Suggested Prompts Guides users toward the agent’s best capabilities through strategic prompt suggestions 3 minutes Summary of tasks Suggest things your agent can do to your end-users through carefully crafted prompts. Scenario: Help users discover the full capabilities of your agent by providing clear, actionable suggestions that demonstrate different use cases. Step-by-step instructions Go to the overview tab for your agent Add suggested prompts: Title Prompt Ask me about benefits What&#39;s the Northwind Health Plus Benefits plan? Ask me about policies What&#39;s the leave policy in Germany? Help fill out meeting notes Capture and structure meeting notes Check on an incident What&#39;s the status of INC0007001? Save the prompts [!TIP] Prompts are visibile to the end-user when the agent is deployed as a Copilot agent. 🏅 Congratulations! You’ve completed Use Case #2! Test your understanding How do suggested prompts improve user adoption and engagement with your agent? What makes an effective suggested prompt versus a generic one? 🔄 Use Case #3: Deploy to Microsoft 365 Copilot Make the agent available in Microsoft 365 Copilot for seamless user access. Use case Value added Estimated effort Deploy to Microsoft 365 Copilot Makes the agent available in Microsoft 365 Copilot for seamless user access 5 minutes Summary of tasks Make the agent available in Microsoft 365 Copilot for your users. Scenario: Deploy your agent where employees already work, ensuring maximum adoption by integrating directly into their daily Microsoft 365 workflow. Step-by-step instructions Go to the agent and select Publish Go to Channels Select Teams and Microsoft 365 Copilot Select Add channel (at the bottom right corner) Close the channel pane Publish the agent again. Select Teams and Microsoft 365 Copilot channel tile Select See agent in Microsoft 365 In the Microsoft 365 Copilot experience, the agent description will pop up. Select Add [!TIP] You may need to give it a few tries/minutes the first time you deploy to Microsoft 365 Copilot so it deploys correctly. If encountering issues, try to publish your agent agent. If this doesn’t work, try in Teams instead: Choose See agents in Teams instead. In the new window, if prompted This site is trying to open Microsoft Teams, select Cancel, and the select use the web app instead Test the agent with the benefits prompt [!TIP] If deploying to Teams, prompts won’t be available, so paste the below question: What&#39;s the Northwind Health Plus Benefits plan? 🏅 Congratulations! You’ve completed Use Case #3! Test your understanding Why is deploying to Microsoft 365 Copilot more effective than standalone deployment for enterprise scenarios? What considerations should you have when choosing deployment channels? 🔄 Use Case #4: Knowledge Prioritization Techniques Implement context-aware knowledge routing for personalized and relevant responses. Use case Value added Estimated effort Knowledge Prioritization Techniques Implements context-aware knowledge routing for personalized and relevant responses 8 minutes Summary of tasks In this section, you’ll learn different techniques to help prioritize the right knowledge sources based on context. Scenario: The SharePoint site has different folders for different country leave policies. Asking “What’s the leave policy?” doesn’t return relevant results and seems to randomly pick a leave policy for a country. You need to implement context-aware routing. Step-by-step instructions Let’s start by asking for the user country at the beginning of the conversation. In many situations, this can be obtained from context, either passed from a web page to the agent, or by making an initial call (for example to the Entra ID connector) to get more information about the logged-in user and their location. Setting an office location in Entra ID Start by assigning an office location to your user. Use the Workshop Agent and ask Set location. You will then be prompted to choose from a list of countries, and then hit Submit. This will update your user’s Office Location property in Microsoft Entra. [!IMPORTANT] Access the workshop agent in the same location as when you created your training user account. You will need the workshop code and your training user’s email address if you previously closed the agent. You can repeat this process as desired. Getting the office location of the logged-in user at the start of the conversation Now, in your ‘Ask Me Anything’ agent, go to the Topics tab, and then to the System topics tab. Open the Conversation Start topic At the beginning of the topic, right after the Trigger, add a new node (+) and choose Add a tool. Go the Connector tab, and search for Microsoft Entra ID Get user Select the Get user connector action and Submit. In the Get user node, select ... and Properties Toggle the End user authentication to Maker-provided credentials. In the Inputs tab, for User Id or Principal Name, select ..., go the the System tab, and select User.Id. Give your topic a name, such as Office Location and Save Test if everything is working as expected by refreshing the conversation test pane. Send a message such as: Hello! Navigate to the Topics tab, open the Office Location topic, and to see what values are returned from the connector, enter the Variables pane in the topic command bar. Go the Test to see the variable values at runtime (i.e., as you are testing in the conversation test pane). Select Value under the GetUser record, and expand it to see if the expected value was returned. Because we will need to use that variable value in other parts and topics of the agent, select the GetUser variable and make it Global. Save Dynamically filtering the searched SharePoint site with the office location Go to the Topics tab, select + Add a topic and choose From blank Update the topic name from Untitled to Leave policy Under Describe what this topic does paste: Use this tool for questions about leave policy, time off, etc. Add a new node: Advanced &gt; Generative answers For input, select ..., go to the System tab and choose the Activity.Text variable. [!TIP] The Activity.Text variable is super useful because it captures the last message/text the user has typed in or selected when interacting with the agent. Go to the properties of the Create generative answers node Select Search only selected sources and don’t select anything [!TIP] This means that none of the knowledge sources that are configured at the top level of your agent will be used. Toggle off Allow the AI to use its own general knowledge (preview) Expand Classic data, for SharePoint (not Public websites!), toggle Manual input to Formula Select the ... and go to the formula tab Paste the SharePoint classic data formula [!IMPORTANT] Use the formula provided in the Lab Resources (specific per training). Notice how the formula concatenates the SharePoint URL with the office location, effectively using context to target the correct source and location for the content. Select Insert once done, then Save your topic Refresh the test pane and ask: What&#39;s the leave policy? Verify that the leave policy used to generate this answer is the one matching the country you selected. [!TIP] If formulas are too much code, you could also use condition nodes and configure different branches based on the selected country. Influence knowledge searches with instructions You can also influence how knowledge searches are performed by updating your agent instructions. Go to the Overview tab and go Edit the Instructions Paste the below line Always start by triggering the topic. Always append the user country () in knowledge search queries (e.g., &quot;&lt;question&gt; in &lt;country&gt;?&quot;) that are HR related. We need to designate the topic to trigger in the instructions. Type / and select Office Location. We also need to set the variable value in-between the parenthesis. Type / and select Power Fx. Type Global.GetUser.officeLocation and select Insert Save the instructions Test What benefits do employees get? Notice how the query is rewritten to take into account the variables you provided, like country, augmenting the chances of returning the correct results for summarization. 🏅 Congratulations! You’ve completed Use Case #4! Test your understanding How does context-aware knowledge routing improve the accuracy of responses? What other user attributes could be used for knowledge prioritization in enterprise scenarios? 🔄 Use Case #5: Create a child IT Support Agent Integrate real-time incident management for comprehensive support capabilities and demonstrate agent scoping techniques. Use case Value added Estimated effort Add ServiceNow Incidents Integrates real-time incident management for comprehensive support capabilities with agent scoping best practices 8 minutes Summary of tasks In this section, you’ll configure the connection to ServiceNow to retrieve incident details, and learn how to scope agent capabilities for specific domains. This demonstrates how specialized tools can be integrated to create domain-specific expertise within your agent. Scenario: Employees need quick access to their ServiceNow incident status without navigating to the ServiceNow portal. By integrating ServiceNow directly into your agent, you’re creating a specialized IT support capability that showcases agent scoping - where specific tools and knowledge are targeted for particular use cases, improving productivity and reducing support burden. Understanding Agent Scoping with ServiceNow Integration This use case demonstrates agent scoping principles: Specialized Tools: ServiceNow integration provides domain-specific capabilities Contextual Routing: IT-related queries automatically leverage ServiceNow tools Unified Experience: Users get comprehensive support from a single agent interface Step-by-step instructions Create a child agent Go to your Ask Me Anything agent Go to the Agents tab, and + Add an agent Update Its Name to: IT Support Agent Its Description to: Use this agent for queries related to IT (e.g., knowledge base frequently asked questions, incident updates, etc.) The agent can multiple multiple questions and queries at once. Its Instructions to: Use knowledge for problem/how-to/questions. Use the Get ServiceNow ticket details tool to get the status of incidents. Add knowledge to the child agent Select + Add in the Knowledge section of the child agent Select ServiceNow Choose the ServiceNow connection under Your connections, and Next Select Knowledge as the knowledge source. Select Add to agent Add ServiceNow ticket details as a Tool to the child agent Save your child Agent Still within the IT Support Agent, scroll down to Tools and + Add a tool Search for ServiceNow List records Select Add and configure Rename to Get ServiceNow ticket details Change description to Gets the details of an incident using its incident number. Use this tool when users ask about ServiceNow tickets, incident status, or IT support requests. [!TIP] The description will help the AI know when to use that tool, so it’s important to have clear instructions WHEN and WHEN NOT to use this tool. This is a key aspect of agent scoping - being specific about tool usage. Under Additional details, change Credentials to use to Maker-provided credentials [!IMPORTANT] In production scenarios, you may want to use the user context when making the connection to ServiceNow. Here, your context (as the author) is used by end-users of your agent when searching for incidents. For Record Type, under Fill using, choose Custom value and choose Incident Select + Add input and choose Query Next to Dynamically fill with AI, select Customize and use this for Description: The output of this variable is the concatenation of numberCONTAINS and the incident number. E.g., &#39;numberCONTAINSINC0007001&#39;. Only the incident number should be prompted and obtained from the user (e.g., INC0007001) [!TIP] Again, these instructions will be used by AI to understand how determine how to pass that information to the ServiceNow connector. In this case, how to use the very specific OData formatting of ServiceNow queries. If you get a “There is an error: ‘DuplicateItem’” error, toggle to Custom value, then switch back to Dynamically fill with AI and set the customized description again. Select + Add input and choose Limit Under Fill using, choose Custom value and set 1 Select Save Test your IT Support Agent Test your agent: My USB port is no longer working on my PC... what can I do? While you&#39;re here, can you also share an update for case INC0000059? It&#39;s been quite a while since I&#39;ve opened them... thanks!! [!TIP] Notice how the agent automatically: Asks the user to consent before running a search using ServiceNow knowledge. Uses the appropriate ServiceNow tool based on the query type Handles multiple tickets in a single request (e.g., if you ask for both cases INC0000059 and INC0000060) Creates user-friendly responses with proper formatting Combines ServiceNow data with other knowledge sources when needed Observe how your agent now demonstrates scoped capabilities: Tool Selection: Automatically chooses the right ServiceNow tool based on user intent Context Preservation: Maintains conversation flow while using specialized tools Domain Expertise: Provides IT-specific guidance and next steps Unified Experience: Seamlessly integrates ServiceNow capabilities with other knowledge sources [!IMPORTANT] This integration showcases how agents can be scoped for specific domains while maintaining a unified user experience. The ServiceNow knowledge and tools are automatically triggered for IT-related queries, demonstrating intelligent capability routing within a single agent. 🏅 Congratulations! You’ve completed Use Case #5! Test your understanding How does ServiceNow integration enhance the employee experience compared to traditional ticket lookup methods? What other enterprise systems could benefit from similar agent integration? 🔄 Use Case #6: Add Custom Knowledge Extend knowledge base with custom HTTP endpoints for enterprise system integration. Use case Value added Estimated effort Add Custom Knowledge Extends knowledge base with custom HTTP endpoints for enterprise system integration 7 minutes Summary of tasks In this section, you’ll configure any third-party knowledge to enrich knowledge results. Scenario: Your organization has custom knowledge systems or APIs that contain valuable information not available in standard connectors. You need to integrate these sources into your agent. Step-by-step instructions Open your Ask Me Anything agent Go to the Topics tab, select + Add a topic and choose From blank Name your topic Custom Knowledge In the topic command bar, select ... and Open code editor. Replace with the below YAML code: kind: AdaptiveDialog beginDialog: kind: OnKnowledgeRequested id: main inputType: {} outputType: {} Once done, select Close code editor Add a new node &gt; Advanced, Send HTTP request For URL, select ..., go the Environment tab, and choose the Custom Knowledge Endpoint variable you had created. Method: Post Response data type: Table Edit schema: kind: Table properties: Article: String Id: String Title: String URL: String Edit Headers and body For Body toggle from No content to JSON content Toggle from Edit JSON to Edit formula and paste the below: { SearchQuery: System.Activity.Text } Under Save response as, select Create a new variable, select the variable name that was created (e.g., Var1) and rename it KnowledgeResults. Add a new node, Variable management &gt; Set a variable value Under Set variable, go to the System tab and choose SearchResults Under To value, select ..., go to the Formula tab, and paste: ForAll( Topic.KnowledgeResults, { Title: Title, Content: Article, ContentLocation: URL } ) [!TIP] What we’re doing here with this formula is slightly transforming the content we receive from the HTTP request to the expected format that will allow to augment the search results, whenever Knowledge is invoked by the generative orchestration. Save Test: How do I update the vendor information for an accounts payable invoice? [!TIP] Notice how the knowledge step returned results that contain citations to a fictitious knowledge base. 🏅 Congratulations! You’ve completed Use Case #6! Test your understanding How does custom knowledge integration expand the capabilities of your agent beyond standard connectors? What considerations should you have when integrating custom APIs for knowledge sources? 🔄 Use Case #7: AI Summary and Review of Meeting Notes Automate document analysis with human review workflows for accuracy and approval. Use case Value added Estimated effort AI Summary and Review of Meeting Notes Automates document analysis with human review workflows for accuracy and approval 7 minutes Summary of tasks In this section, you’ll learn how to upload files and run files through a prompt for analysis, and how to use adaptive cards to ask for human review for edits before submitting a meeting report. Scenario: Employees need help structuring meeting notes efficiently while maintaining human oversight for accuracy. You’ll implement AI-powered analysis with human review workflows. Step-by-step instructions Open your Ask Me Anything agent Go to the Topics tab, select + Add a topic and choose From blank Name your topic Meeting Notes Under Describe what this topic does paste: Use this tool to help users with meeting notes Add a Question node: Sure, I can help you with that! Please upload your meeting notes Under Identify, select File Rename the Save user response as variable from Var1 to File Add a new node, Add a tool, New prompt Change the Name to Meeting AI Notes Keep the Model as GPT-4.1 mini or use GPT-4o if not available Select + Add content, and choose Image or Document [!IMPORTANT] As a sample, use the Meeting Minutes.pdf file provided in the Lab Resources (specific per training). Rename the input to UploadedNotes In the Instructions, just below UploadedNotes, paste: Using the content of the uploaded document, populate the following JSON record (for the schema, only string properties, no arrays, except for Data and time) with: - Title of the meeting - Description/summary - Date and time - List of attendees - Action items / next steps { &quot;MeetingTitle&quot;: &quot;Title of the meeting&quot;, &quot;MeetingSummary&quot;: &quot;Description/summary&quot;, &quot;MeetingDateTime&quot;: &quot;Date and time&quot;, &quot;MeetingAttendees&quot;: &quot;List of attendees&quot;, &quot;MeetingActions&quot;: &quot;Action items / next steps&quot; } Change the Output to JSON Test your prompt Save your prompt Save the topic. In the Prompt node, choose the File variable as the input for UploadedNotes. Create a new variable for the output of the prompt node, and rename it MeetingAINotes Add a new node, Ask with Adaptive Card Go to Adaptive Card node properties. Select Edit adaptive card. In the Card payload editor, paste the below JSON: { &quot;type&quot;: &quot;AdaptiveCard&quot;, &quot;version&quot;: &quot;1.5&quot;, &quot;$schema&quot;: &quot;https://adaptivecards.io/schemas/adaptive-card.json&quot;, &quot;body&quot;: [ { &quot;type&quot;: &quot;TextBlock&quot;, &quot;text&quot;: &quot;Please review and confirm the meeting minutes&quot;, &quot;weight&quot;: &quot;Bolder&quot;, &quot;size&quot;: &quot;Medium&quot; }, { &quot;type&quot;: &quot;Input.Text&quot;, &quot;id&quot;: &quot;meetingTitle&quot;, &quot;label&quot;: &quot;Meeting title&quot;, &quot;value&quot;: &quot;&lt;Replace with MeetingTitle&gt;&quot; }, { &quot;type&quot;: &quot;Input.Text&quot;, &quot;id&quot;: &quot;attendees&quot;, &quot;label&quot;: &quot;Attendees&quot;, &quot;value&quot;: &quot;&lt;Replace with MeetingAttendees&gt;&quot; }, { &quot;type&quot;: &quot;Input.Text&quot;, &quot;id&quot;: &quot;date&quot;, &quot;label&quot;: &quot;Date and time&quot;, &quot;value&quot;: &quot;&lt;Replace with MeetingDateTime&gt;&quot; }, { &quot;type&quot;: &quot;Input.Text&quot;, &quot;id&quot;: &quot;summary&quot;, &quot;label&quot;: &quot;Meeting summary&quot;, &quot;isMultiline&quot;: true, &quot;value&quot;: &quot;&lt;Replace with MeetingSummary&gt;&quot; }, { &quot;type&quot;: &quot;Input.Text&quot;, &quot;id&quot;: &quot;nextSteps&quot;, &quot;label&quot;: &quot;Next steps&quot;, &quot;isMultiline&quot;: true, &quot;value&quot;: &quot;&lt;Replace with MeetingActions&gt;&quot; } ], &quot;actions&quot;: [ { &quot;type&quot;: &quot;Action.Submit&quot;, &quot;title&quot;: &quot;Confirm minutes&quot; } ] } Select Save and Close. [!TIP] Notice how the Adaptive Card editor offers a visual editor to create your own Adaptive Card experience with a no-code/low-code editor. We now need to make the card dynamic to reference the content that was returned from the prompt. Toggle from JSON card to Formula card. Expand the formula for more screen real estate. For each &quot;&lt;Replace with ...&gt;&quot;, replace with the matching Topic.MeetingAINotes.structuredOutput.&lt;property&gt; variable. Don’t forget to remove the double quotes. Save your topic Add a new Message node, and paste: Thank you! I&#39;ve successfully logged your meeting notes in our systems. Test your agent. Try to modify the content directly in the adaptive card before selecting Confirm minutes. Please help me with my meeting notes [!IMPORTANT] Note: the lab ends here, but imagine storing these in system of records, for example Dataverse, as a next step, after the user has confirmed the content. 🏅 Congratulations! You’ve completed Use Case #7! Test your understanding What are the benefits of implementing human review workflows in AI-powered document analysis? How could you extend this pattern to other document types in your organization? What next steps could you implement to store the confirmed meeting notes? Challenge: Apply this to your own use case What other document types could benefit from AI-powered analysis and structuring? How could you implement approval workflows for AI-generated content in your organization? What integration points would be valuable for storing confirmed content? 🏆 Summary of learnings True learning comes from doing, questioning, and reflecting—so let’s put your skills to the test. To maximize the impact of your “Ask me anything” agent: Knowledge Integration – Connect multiple data sources to provide comprehensive answers from a single conversational interface, eliminating information silos Context Awareness – Implement dynamic knowledge routing based on user attributes to ensure personalized and relevant responses Seamless Deployment – Deploy to Microsoft 365 Copilot to meet employees where they already work, maximizing adoption and convenience AI with Human Oversight – Combine AI-powered automation with human review processes to maintain accuracy while improving efficiency Continuous Improvement – Monitor usage patterns and user feedback to iteratively enhance knowledge sources and response quality Conclusions and recommendations Ask me anything agent golden rules: Start with high-value, frequently asked questions to demonstrate immediate ROI Implement proper authentication and permissions to ensure knowledge security Use suggested prompts to guide users toward the agent’s best capabilities Design context-aware experiences that reduce user input while increasing relevance Maintain human oversight for critical processes while automating routine tasks Monitor and analyze conversation patterns to identify knowledge gaps and improvement opportunities By following these principles, you’ll create an intelligent knowledge hub that transforms how employees access information, reduces support burden, and improves organizational efficiency through conversational AI.","headline":"Ask Me Anything Agent","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/mcs-labs/labs/ask-me-anything/"},"url":"http://0.0.0.0:4000/mcs-labs/labs/ask-me-anything/"}</script>
<!-- End Jekyll SEO tag -->

</head>
<body>
    <header class="site-header">
        <div class="container">
            <h1><a href="/mcs-labs/">Microsoft Copilot Studio Labs</a></h1>
            <nav>
                <a href="/mcs-labs/">Home</a>
                <a href="/mcs-labs/labs/">All Labs</a>
            </nav>
        </div>
    </header>

    <main class="site-content">
        <div class="container">
            <article class="lab-content">
    <header class="lab-header">
        <h1>Ask Me Anything Agent</h1>
        
        <div class="lab-meta">
            <span class="duration">⏱️ 90 minutes</span>
            
            <span class="difficulty">📊 200</span>
            
        </div>
        
    </header>

    <div class="lab-body">
        <h1 id="create-an-ask-me-anything-agent-for-your-employees">Create an ‘Ask me anything’ agent for your employees</h1>

<p>Empower employees with answers that matter – Build an intelligent agent that connects to your knowledge and data.</p>

<hr />

<h2 id="-lab-details">🧭 Lab Details</h2>

<table>
  <thead>
    <tr>
      <th>Level</th>
      <th>Persona</th>
      <th>Duration</th>
      <th>Purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>200</td>
      <td>Maker</td>
      <td>40 minutes</td>
      <td>After completing this lab, participants will be able to create an intelligent “Ask me anything” agent that connects to multiple knowledge sources including SharePoint, ServiceNow, and custom knowledge bases. Participants will learn to configure knowledge prioritization, deploy agents to Microsoft 365 Copilot, and implement AI-powered document analysis with human review workflows.</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-table-of-contents">📚 Table of Contents</h2>

<ul>
  <li><a href="#-why-this-matters">Why This Matters</a></li>
  <li><a href="#-introduction">Introduction</a></li>
  <li><a href="#-core-concepts-overview">Core Concepts Overview</a></li>
  <li><a href="#-documentation-and-additional-training-links">Documentation and Additional Training Links</a></li>
  <li><a href="#-prerequisites">Prerequisites</a></li>
  <li><a href="#-summary-of-targets">Summary of Targets</a></li>
  <li><a href="#-use-cases-covered">Use Cases Covered</a></li>
  <li><a href="#️-instructions-by-use-case">Instructions by Use Case</a>
    <ul>
      <li><a href="#-use-case-1-create-an-ask-me-anything-agent-and-add-sharepoint-knowledge-source">Use Case #1: Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source</a></li>
      <li><a href="#-use-case-2-configure-suggested-prompts">Use Case #2: Configure Suggested Prompts</a></li>
      <li><a href="#-use-case-3-deploy-to-microsoft-365-copilot">Use Case #3: Deploy to Microsoft 365 Copilot</a></li>
      <li><a href="#-use-case-4-knowledge-prioritization-techniques">Use Case #4: Knowledge Prioritization Techniques</a></li>
      <li><a href="#-use-case-5-create-a-child-it-support-agent">Use Case #5: Create a child IT Support Agent</a></li>
      <li><a href="#-use-case-6-add-custom-knowledge">Use Case #6: Add Custom Knowledge</a></li>
      <li><a href="#-use-case-7-ai-summary-and-review-of-meeting-notes">Use Case #7: AI Summary and Review of Meeting Notes</a></li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="-why-this-matters">🤔 Why This Matters</h2>

<p><strong>Makers and IT professionals</strong> - Tired of employees constantly asking the same questions about policies, benefits, or system status? Frustrated by scattered knowledge across multiple systems?</p>

<p>Think of your organization’s knowledge like a library:</p>
<ul>
  <li><strong>Without an intelligent agent</strong>: Employees waste hours searching through SharePoint folders, submitting IT tickets for simple questions, and interrupting colleagues for information that should be readily available</li>
  <li><strong>With an intelligent agent</strong>: Employees get instant, accurate answers from a single conversational interface that automatically searches across all your knowledge sources with proper citations</li>
</ul>

<p><strong>Common challenges solved by this lab:</strong></p>
<ul>
  <li>“I can’t find the leave policy for my country in our SharePoint site”</li>
  <li>“What’s the status of my ServiceNow incident?”</li>
  <li>“Can someone help me structure these meeting notes properly?”</li>
  <li>“I need information from multiple systems but don’t know where to look”</li>
</ul>

<p><strong>This 40-minute investment will save your organization countless hours and improve employee satisfaction by providing instant access to knowledge.</strong></p>

<hr />

<h2 id="-introduction">🌐 Introduction</h2>

<p>In today’s fast-paced business environment, employees need quick access to accurate information from multiple sources. Whether it’s HR policies, IT incident status, or custom knowledge bases, information is often scattered across different systems, making it difficult for employees to find what they need efficiently.</p>

<p><strong>Real-world example:</strong> Imagine Sarah, a new employee in Germany, needs to understand her leave entitlements. Currently, she might spend 30 minutes navigating through SharePoint folders, trying different search terms, or even asking HR colleagues. With an intelligent “Ask me anything” agent, Sarah simply types “What’s the leave policy for Germany?” and instantly receives the accurate policy document with proper citations, saving time and reducing frustration.</p>

<p>This lab teaches you to build a comprehensive solution that transforms how employees interact with organizational knowledge, creating a single conversational interface that intelligently routes questions to the right knowledge sources and provides contextual, accurate responses.</p>

<hr />

<h2 id="-core-concepts-overview">🎓 Core Concepts Overview</h2>

<table>
  <thead>
    <tr>
      <th>Concept</th>
      <th>Why it matters</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Knowledge Source Integration</strong></td>
      <td>Connects your agent to multiple data sources (SharePoint, ServiceNow, custom APIs) so employees get comprehensive answers from a single interface, eliminating the need to search multiple systems.</td>
    </tr>
    <tr>
      <td><strong>Context-Aware Knowledge Prioritization</strong></td>
      <td>Intelligently routes questions to the most relevant knowledge sources based on user context (location, role, etc.), ensuring employees get personalized and accurate information.</td>
    </tr>
    <tr>
      <td><strong>Microsoft 365 Copilot Deployment</strong></td>
      <td>Makes your agent available where employees already work, integrating seamlessly into their daily Microsoft 365 workflow for maximum adoption and convenience.</td>
    </tr>
    <tr>
      <td><strong>AI-Powered Document Analysis</strong></td>
      <td>Automates the processing and structuring of unstructured content like meeting notes, reducing manual work while maintaining human oversight for accuracy and approval.</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="-documentation-and-additional-training-links">📄 Documentation and Additional Training Links</h2>

<ul>
  <li><a href="https://learn.microsoft.com/en-us/microsoft-copilot-studio/">Microsoft Copilot Studio Documentation</a></li>
  <li><a href="https://learn.microsoft.com/en-us/microsoft-copilot-studio/nlu-boost-conversations">Knowledge Sources in Copilot Studio</a></li>
  <li><a href="https://learn.microsoft.com/en-us/microsoft-copilot-studio/publication-connect-bot-to-custom-application">Deploy Copilot Studio agents to Microsoft 365</a></li>
  <li><a href="https://learn.microsoft.com/en-us/connectors/service-now/">ServiceNow connector for Power Platform</a></li>
  <li><a href="https://learn.microsoft.com/en-us/adaptive-cards/">Adaptive Cards for Interactive Experiences</a></li>
</ul>

<hr />

<h2 id="-prerequisites">✅ Prerequisites</h2>

<ul>
  <li>Access to Microsoft Copilot Studio with appropriate licensing.</li>
  <li>Access to SharePoint Online with sample knowledge content.</li>
  <li>ServiceNow access for incident management integration (demo environment provided).</li>
  <li>Understanding of basic conversational AI concepts and Microsoft 365 administration.</li>
</ul>

<hr />

<h2 id="-summary-of-targets">🎯 Summary of Targets</h2>

<p>In this lab, you’ll build a comprehensive “Ask me anything” agent that serves as a central knowledge hub for your organization. By the end of the lab, you will:</p>

<ul>
  <li>Create an ‘Ask me Anything’ agent and add SharePoint as a knowledge source.</li>
  <li>Configure suggested prompts for better user guidance.</li>
  <li>Deploy to Microsoft 365 Copilot for seamless integration.</li>
  <li>Learn to prioritize knowledge sources based on user context.</li>
  <li>Add ServiceNow incidents integration for real-time ticket status.</li>
  <li>Add custom knowledge sources via HTTP requests.</li>
  <li>Implement AI summary and review of meeting notes with human oversight.</li>
</ul>

<hr />

<h2 id="-use-cases-covered">🧩 Use Cases Covered</h2>

<table>
  <thead>
    <tr>
      <th>Step</th>
      <th>Use Case</th>
      <th>Value added</th>
      <th>Effort</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td><a href="#-use-case-1-create-an-ask-me-anything-agent-and-add-sharepoint-knowledge-source">Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source</a></td>
      <td>Establishes foundational agent with SharePoint knowledge integration and grounded AI responses</td>
      <td>5 min</td>
    </tr>
    <tr>
      <td>2</td>
      <td><a href="#-use-case-2-configure-suggested-prompts">Configure Suggested Prompts</a></td>
      <td>Guides users toward the agent’s best capabilities through strategic prompt suggestions</td>
      <td>3 min</td>
    </tr>
    <tr>
      <td>3</td>
      <td><a href="#-use-case-3-deploy-to-microsoft-365-copilot">Deploy to Microsoft 365 Copilot</a></td>
      <td>Makes the agent available in Microsoft 365 Copilot for seamless user access</td>
      <td>5 min</td>
    </tr>
    <tr>
      <td>4</td>
      <td><a href="#-use-case-4-knowledge-prioritization-techniques">Knowledge Prioritization Techniques</a></td>
      <td>Implements context-aware knowledge routing for personalized and relevant responses</td>
      <td>8 min</td>
    </tr>
    <tr>
      <td>5</td>
      <td><a href="#-use-case-5-create-a-child-it-support-agent">Use Case #5: Create a child IT Support Agent</a></td>
      <td>Discover how scoping for knowledge and tools can also be done through the multi-agent capabilitis.</td>
      <td>5 min</td>
    </tr>
    <tr>
      <td>6</td>
      <td><a href="#-use-case-6-add-custom-knowledge">Add Custom Knowledge</a></td>
      <td>Extends knowledge base with custom HTTP endpoints for enterprise system integration</td>
      <td>7 min</td>
    </tr>
    <tr>
      <td>7</td>
      <td><a href="#-use-case-7-ai-summary-and-review-of-meeting-notes">AI Summary and Review of Meeting Notes</a></td>
      <td>Automates document analysis with human review workflows for accuracy and approval</td>
      <td>7 min</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="️-instructions-by-use-case">🛠️ Instructions by Use Case</h2>

<hr />

<h2 id="-use-case-1-create-an-ask-me-anything-agent-and-add-sharepoint-knowledge-source">🧱 Use Case #1: Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source</h2>

<p>Create a foundational intelligent agent with SharePoint integration for grounded AI responses.</p>

<table>
  <thead>
    <tr>
      <th>Use case</th>
      <th>Value added</th>
      <th>Estimated effort</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Create an ‘Ask Me Anything’ Agent and Add SharePoint Knowledge Source</td>
      <td>Establishes foundational agent with SharePoint knowledge integration and grounded AI responses</td>
      <td>5 minutes</td>
    </tr>
  </tbody>
</table>

<p><strong>Summary of tasks</strong></p>

<p>In this section, you’ll learn how to access the Solutions area of Copilot Studio, create a new agent, and integrate SharePoint as a knowledge source.</p>

<p><strong>Scenario:</strong> Properly setup your development environment so that you can later easily package and deploy your agents to other environments. Your organization has extensive knowledge stored in SharePoint that needs to be accessible through conversational AI.</p>

<h3 id="objective">Objective</h3>

<p>Create a new agent with SharePoint knowledge integration that provides grounded, cited responses.</p>

<hr />

<h3 id="step-by-step-instructions">Step-by-step instructions</h3>

<ol>
  <li>
    <p>Navigate to the Copilot Studio home page at <a href="https://copilotstudio.microsoft.com/">copilotstudio.microsoft.com</a></p>
  </li>
  <li>
    <p>Go to the Solutions menu (located in the left-hand menu under the ellipsis …)</p>
  </li>
  <li>
    <p>Select the solution you had created</p>
  </li>
  <li>
    <p>Select <strong>New</strong>, and choose <strong>Agent</strong></p>
  </li>
  <li>
    <p>Select the <strong>Configure</strong> tab</p>
  </li>
  <li>
    <p>Name your agent <code class="language-plaintext highlighter-rouge">Ask Me Anything</code></p>
  </li>
  <li>
    <p>Select <strong>Create</strong></p>
  </li>
  <li>
    <p>Go to <strong>Knowledge</strong></p>
  </li>
</ol>

<p><img src="images/knowledge-sharepoint.png" alt="alt text" /></p>

<ol>
  <li>Select <strong>SharePoint</strong>, and paste the SharePoint Knowledge URL and select <strong>Add</strong>.</li>
</ol>

<blockquote>
  <p>[!IMPORTANT]</p>
  <ul>
    <li>For configuration, use the provided values in the <strong>Lab Resources</strong> (specific per training).</li>
  </ul>
</blockquote>

<ol>
  <li>
    <p>Choose <strong>Add</strong></p>
  </li>
  <li>
    <p>Test your agent with this question:</p>
  </li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>What's the Northwind Health Plus Benefits plan?
</code></pre></div></div>

<blockquote>
  <p>[!TIP]</p>
  <ul>
    <li>Notice how relevant it is, and how the citations are accurate. This demonstrates the power of grounded AI responses.</li>
  </ul>
</blockquote>

<hr />

<h3 id="-congratulations-youve-completed-use-case-1">🏅 Congratulations! You’ve completed Use Case #1!</h3>

<hr />

<h3 id="test-your-understanding">Test your understanding</h3>

<p><strong>Key takeaways:</strong></p>

<ul>
  <li><strong>Solution Management</strong> – Using solutions ensures proper environment management and deployment capabilities</li>
  <li><strong>Knowledge Integration</strong> – SharePoint integration provides immediate access to organizational documents with proper citations</li>
  <li><strong>Grounded AI</strong> – The agent automatically provides source citations, ensuring transparency and trust in responses</li>
</ul>

<hr />

<h2 id="-use-case-2-configure-suggested-prompts">🔄 Use Case #2: Configure Suggested Prompts</h2>

<p>Guide users toward your agent’s best capabilities through strategic prompt suggestions.</p>

<table>
  <thead>
    <tr>
      <th>Use case</th>
      <th>Value added</th>
      <th>Estimated effort</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Configure Suggested Prompts</td>
      <td>Guides users toward the agent’s best capabilities through strategic prompt suggestions</td>
      <td>3 minutes</td>
    </tr>
  </tbody>
</table>

<p><strong>Summary of tasks</strong></p>

<p>Suggest things your agent can do to your end-users through carefully crafted prompts.</p>

<p><strong>Scenario:</strong> Help users discover the full capabilities of your agent by providing clear, actionable suggestions that demonstrate different use cases.</p>

<h3 id="step-by-step-instructions-1">Step-by-step instructions</h3>

<ol>
  <li>
    <p>Go to the <strong>overview</strong> tab for your agent</p>
  </li>
  <li>
    <p>Add suggested prompts:</p>
  </li>
</ol>

<table>
  <thead>
    <tr>
      <th>Title</th>
      <th>Prompt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Ask me about benefits</code></td>
      <td><code class="language-plaintext highlighter-rouge">What's the Northwind Health Plus Benefits plan?</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Ask me about policies</code></td>
      <td><code class="language-plaintext highlighter-rouge">What's the leave policy in Germany?</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Help fill out meeting notes</code></td>
      <td><code class="language-plaintext highlighter-rouge">Capture and structure meeting notes</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Check on an incident</code></td>
      <td><code class="language-plaintext highlighter-rouge">What's the status of INC0007001?</code></td>
    </tr>
  </tbody>
</table>

<ol>
  <li><strong>Save</strong> the prompts</li>
</ol>

<blockquote>
  <p>[!TIP]</p>
  <ul>
    <li>Prompts are visibile to the end-user when the agent is deployed as a Copilot agent.</li>
  </ul>
</blockquote>

<hr />

<h3 id="-congratulations-youve-completed-use-case-2">🏅 Congratulations! You’ve completed Use Case #2!</h3>

<hr />

<h3 id="test-your-understanding-1">Test your understanding</h3>

<ul>
  <li>How do suggested prompts improve user adoption and engagement with your agent?</li>
  <li>What makes an effective suggested prompt versus a generic one?</li>
</ul>

<hr />

<h2 id="-use-case-3-deploy-to-microsoft-365-copilot">🔄 Use Case #3: Deploy to Microsoft 365 Copilot</h2>

<p>Make the agent available in Microsoft 365 Copilot for seamless user access.</p>

<table>
  <thead>
    <tr>
      <th>Use case</th>
      <th>Value added</th>
      <th>Estimated effort</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Deploy to Microsoft 365 Copilot</td>
      <td>Makes the agent available in Microsoft 365 Copilot for seamless user access</td>
      <td>5 minutes</td>
    </tr>
  </tbody>
</table>

<p><strong>Summary of tasks</strong></p>

<p>Make the agent available in Microsoft 365 Copilot for your users.</p>

<p><strong>Scenario:</strong> Deploy your agent where employees already work, ensuring maximum adoption by integrating directly into their daily Microsoft 365 workflow.</p>

<h3 id="step-by-step-instructions-2">Step-by-step instructions</h3>

<ol>
  <li>
    <p>Go to the agent and select <strong>Publish</strong></p>
  </li>
  <li>
    <p>Go to <strong>Channels</strong></p>
  </li>
  <li>
    <p>Select <strong>Teams and Microsoft 365 Copilot</strong></p>
  </li>
  <li>
    <p>Select <strong>Add channel</strong> (at the bottom right corner)</p>
  </li>
  <li>
    <p><strong>Close</strong> the channel pane</p>
  </li>
  <li>
    <p><strong>Publish</strong> the agent again.</p>
  </li>
  <li>
    <p>Select <strong>Teams and Microsoft 365 Copilot</strong> channel tile</p>
  </li>
  <li>
    <p>Select <strong>See agent in Microsoft 365</strong></p>

    <p><img src="images/m365-copilot-channel.png" alt="alt text" /></p>
  </li>
  <li>
    <p>In the <strong>Microsoft 365 Copilot</strong> experience, the agent description will pop up. Select <strong>Add</strong></p>
  </li>
</ol>

<blockquote>
  <p>[!TIP]</p>
  <ul>
    <li>You may need to give it a few tries/minutes the first time you deploy to Microsoft 365 Copilot so it deploys correctly.</li>
    <li>If encountering issues, try to publish your agent agent.</li>
    <li>If this doesn’t work, try in Teams instead:
      <ul>
        <li>Choose <strong>See agents in Teams</strong> instead.</li>
        <li>In the new window, if prompted <em>This site is trying to open Microsoft Teams</em>, select <strong>Cancel</strong>, and the select <strong>use the web app instead</strong></li>
      </ul>
    </li>
  </ul>
</blockquote>

<ol>
  <li>Test the agent with the benefits prompt</li>
</ol>

<blockquote>
  <p>[!TIP]
If deploying to Teams,  prompts won’t be available, so paste the below question:</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>What's the Northwind Health Plus Benefits plan?
</code></pre></div>  </div>
</blockquote>

<hr />

<h3 id="-congratulations-youve-completed-use-case-3">🏅 Congratulations! You’ve completed Use Case #3!</h3>

<hr />

<h3 id="test-your-understanding-2">Test your understanding</h3>

<ul>
  <li>Why is deploying to Microsoft 365 Copilot more effective than standalone deployment for enterprise scenarios?</li>
  <li>What considerations should you have when choosing deployment channels?</li>
</ul>

<hr />

<h2 id="-use-case-4-knowledge-prioritization-techniques">🔄 Use Case #4: Knowledge Prioritization Techniques</h2>

<p>Implement context-aware knowledge routing for personalized and relevant responses.</p>

<table>
  <thead>
    <tr>
      <th>Use case</th>
      <th>Value added</th>
      <th>Estimated effort</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Knowledge Prioritization Techniques</td>
      <td>Implements context-aware knowledge routing for personalized and relevant responses</td>
      <td>8 minutes</td>
    </tr>
  </tbody>
</table>

<p><strong>Summary of tasks</strong></p>

<p>In this section, you’ll learn different techniques to help prioritize the right knowledge sources based on context.</p>

<p><strong>Scenario:</strong> The SharePoint site has different folders for different country leave policies. Asking “What’s the leave policy?” doesn’t return relevant results and seems to randomly pick a leave policy for a country. You need to implement context-aware routing.</p>

<h3 id="step-by-step-instructions-3">Step-by-step instructions</h3>

<p>Let’s start by asking for the user country at the beginning of the conversation. In many situations, this can be obtained from context, either passed from a web page to the agent, or by making an initial call (for example to the Entra ID connector) to get more information about the logged-in user and their location.</p>

<h4 id="setting-an-office-location-in-entra-id">Setting an office location in Entra ID</h4>

<ol>
  <li>Start by assigning an office location to your user. Use the <strong>Workshop Agent</strong>  and ask <code class="language-plaintext highlighter-rouge">Set location</code>. You will then be prompted to choose from a list of countries, and then hit <strong>Submit</strong>. This will update your user’s Office Location property in Microsoft Entra.</li>
</ol>

<blockquote>
  <p>[!IMPORTANT]</p>
  <ul>
    <li>Access the workshop agent in the same location as when you created your training user account.</li>
    <li>You will need the workshop code and your training user’s email address if you previously closed the agent.</li>
    <li>You can repeat this process as desired.</li>
  </ul>
</blockquote>

<h4 id="getting-the-office-location-of-the-logged-in-user-at-the-start-of-the-conversation">Getting the office location of the logged-in user at the start of the conversation</h4>

<!-- replacing with instrucftions on how to do this on message received, so it works in M365 channel too

2. Now, in your 'Ask Me Anything' agent, go to the **Topics** tab, and then to the **System topics** tab.

3. Open the **Conversation Start** topic

4. At the beginning of the topic, right after the **Trigger**, add a new node **(+)** and choose **Add a tool**.

5. Go the **Connector** tab, and search for `Microsoft Entra ID Get user`

6. Select the **Get user** connector action and **Submit**.

  ![alt text](images/add-tool-connector.png)

> [!IMPORTANT]
> - If you don't see the **Get user** action, select another of the Microsoft Entra ID actions, such as **Create user**  and **Submit**.
> - Then in the topic command bar, select `...` and **Open code editor**.
> - Update `CreateUser` to `GetUser` in both **operationId** and **variable**.
> - Select **Close code editor**.
> - In the **Get user** node, select `...` and **Refresh** 

7. In the **Get user** node, select `...` and **Properties** 

8. Toggle the **End user authentication** to **Agent author authentication**.

9. In the **Inputs** tab, for **User Id or Principal Name**, select `...`, go the the **System** tab, and select **User.Id**.

![alt text](images/select-user-id.png)

10. **Save**

 -->

<ol>
  <li>
    <p>Now, in your ‘Ask Me Anything’ agent, go to the <strong>Topics</strong> tab, and then to the <strong>System topics</strong> tab.</p>
  </li>
  <li>
    <p>Open the <strong>Conversation Start</strong> topic</p>
  </li>
  <li>
    <p>At the beginning of the topic, right after the <strong>Trigger</strong>, add a new node <strong>(+)</strong> and choose <strong>Add a tool</strong>.</p>
  </li>
  <li>
    <p>Go the <strong>Connector</strong> tab, and search for <code class="language-plaintext highlighter-rouge">Microsoft Entra ID Get user</code></p>
  </li>
  <li>
    <p>Select the <strong>Get user</strong> connector action and <strong>Submit</strong>.</p>
  </li>
</ol>

<p><img src="images/add-tool-connector.png" alt="alt text" /></p>

<ol>
  <li>
    <p>In the <strong>Get user</strong> node, select <code class="language-plaintext highlighter-rouge">...</code> and <strong>Properties</strong></p>
  </li>
  <li>
    <p>Toggle the <strong>End user authentication</strong> to <strong>Maker-provided credentials</strong>.</p>
  </li>
  <li>
    <p>In the <strong>Inputs</strong> tab, for <strong>User Id or Principal Name</strong>, select <code class="language-plaintext highlighter-rouge">...</code>, go the the <strong>System</strong> tab, and select <strong>User.Id</strong>.</p>
  </li>
</ol>

<p><img src="images/select-user-id.png" alt="alt text" /></p>

<ol>
  <li>
    <p>Give your topic a name, such as <code class="language-plaintext highlighter-rouge">Office Location</code> and <strong>Save</strong></p>
  </li>
  <li>
    <p>Test if everything is working as expected by <strong>refreshing</strong> the conversation test pane.</p>
  </li>
  <li>
    <p><strong>Send</strong> a message such as:</p>
  </li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hello!
</code></pre></div></div>

<ol>
  <li>Navigate to the <strong>Topics</strong> tab, open the <strong>Office Location</strong> topic, and to see what values are returned from the connector, enter the <strong>Variables</strong> pane in the topic command bar. Go the <strong>Test</strong> to see the variable values at runtime (i.e., as you are testing in the conversation test pane).</li>
</ol>

<p><img src="images/variables-pane.png" alt="alt text" /></p>

<ol>
  <li>Select <strong>Value</strong> under the <strong>GetUser</strong> record, and <strong>expand</strong> it to see if the expected value was returned.</li>
</ol>

<p><img src="images/user-record-entra-id.png" alt="alt text" /></p>

<ol>
  <li>Because we will need to use that variable value in other parts and topics of the agent, select the <strong>GetUser</strong> variable and make it <strong>Global</strong>.</li>
</ol>

<p><img src="images/set-global-variable.png" alt="alt text" /></p>

<ol>
  <li><strong>Save</strong></li>
</ol>

<h4 id="dynamically-filtering-the-searched-sharepoint-site-with-the-office-location">Dynamically filtering the searched SharePoint site with the office location</h4>

<ol>
  <li>
    <p>Go to the <strong>Topics</strong> tab, select <strong>+ Add a topic</strong> and choose <strong>From blank</strong></p>
  </li>
  <li>
    <p>Update the topic name from <strong>Untitled</strong> to <code class="language-plaintext highlighter-rouge">Leave policy</code></p>
  </li>
  <li>
    <p>Under <strong>Describe what this topic does</strong> paste:</p>
  </li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Use this tool for questions about leave policy, time off, etc.
</code></pre></div></div>

<ol>
  <li>
    <p>Add a new node: <strong>Advanced &gt; Generative answers</strong></p>
  </li>
  <li>
    <p>For input,  select <code class="language-plaintext highlighter-rouge">...</code>, go to the <strong>System</strong> tab and choose the <strong>Activity.Text</strong> variable.</p>
  </li>
</ol>

<blockquote>
  <p>[!TIP]
The <strong>Activity.Text</strong> variable is super useful because it captures the last message/text the user has typed in or selected when interacting with the agent.</p>
</blockquote>

<p><img src="images/activity-text.png" alt="alt text" /></p>

<ol>
  <li>
    <p>Go to the <strong>properties</strong> of the <strong>Create generative answers</strong> node</p>
  </li>
  <li>
    <p>Select <strong>Search only selected sources</strong> and <strong>don’t select anything</strong></p>
  </li>
</ol>

<blockquote>
  <p>[!TIP]
This means that none of the knowledge sources that are configured at the top level of your agent will be used.</p>
</blockquote>

<ol>
  <li>
    <p>Toggle off <strong>Allow the AI to use its own general knowledge (preview)</strong></p>
  </li>
  <li>
    <p>Expand <strong>Classic data</strong>, for <strong>SharePoint</strong> (not Public websites!), toggle <strong>Manual input</strong> to <strong>Formula</strong></p>
  </li>
  <li>
    <p>Select the <code class="language-plaintext highlighter-rouge">...</code> and go to the <strong>formula</strong> tab</p>
  </li>
  <li>
    <p>Paste the <strong>SharePoint classic data formula</strong></p>
  </li>
</ol>

<blockquote>
  <p>[!IMPORTANT]</p>
  <ul>
    <li>Use the formula provided in the <strong>Lab Resources</strong> (specific per training).</li>
    <li>Notice how the formula concatenates the SharePoint URL with the office location, effectively using context to target the correct source and location for the content.</li>
  </ul>
</blockquote>

<p><img src="images/sharepoint-formulas.png" alt="alt text" /></p>

<ol>
  <li>
    <p>Select <strong>Insert</strong> once done, then <strong>Save</strong> your topic</p>
  </li>
  <li>
    <p><strong>Refresh</strong> the test pane and ask:</p>
  </li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>What's the leave policy?
</code></pre></div></div>

<ol>
  <li><strong>Verify</strong> that the leave policy used to generate this answer is the one matching the country you selected.</li>
</ol>

<blockquote>
  <p>[!TIP]
If formulas are too much code, you could also use condition nodes and configure different branches based on the selected country.</p>
</blockquote>

<h4 id="influence-knowledge-searches-with-instructions">Influence knowledge searches with instructions</h4>

<ol>
  <li>
    <p>You can also influence how knowledge searches are performed by updating your agent instructions. Go to the <strong>Overview</strong> tab and go <strong>Edit</strong> the <strong>Instructions</strong></p>
  </li>
  <li>
    <p><strong>Paste</strong> the below line</p>
  </li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Always start by triggering the  topic.
Always append the user country () in knowledge search queries (e.g., "&lt;question&gt; in &lt;country&gt;?") that are HR related.
</code></pre></div></div>

<ol>
  <li>
    <p>We need to designate the topic to trigger in the instructions. <strong>Type</strong> <code class="language-plaintext highlighter-rouge">/</code> and select <strong>Office Location</strong>.</p>
  </li>
  <li>
    <p>We also need to set the variable value in-between the parenthesis. <strong>Type</strong> <code class="language-plaintext highlighter-rouge">/</code> and select <strong>Power Fx</strong>.</p>
  </li>
</ol>

<p><img src="images/instructions-formula.png" alt="alt text" /></p>

<ol>
  <li>
    <p><strong>Type</strong> <code class="language-plaintext highlighter-rouge">Global.GetUser.officeLocation</code> and select <strong>Insert</strong></p>
  </li>
  <li>
    <p><strong>Save</strong> the instructions</p>
  </li>
  <li>
    <p><strong>Test</strong></p>
  </li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>What benefits do employees get?
</code></pre></div></div>

<ol>
  <li>Notice how the query is <strong>rewritten</strong> to take into account the <strong>variables</strong> you provided, like country, <strong>augmenting the chances</strong> of returning the correct results for summarization.</li>
</ol>

<p><img src="images/rewritten-search-query.png" alt="alt text" /></p>

<hr />

<h3 id="-congratulations-youve-completed-use-case-4">🏅 Congratulations! You’ve completed Use Case #4!</h3>

<hr />

<h3 id="test-your-understanding-3">Test your understanding</h3>

<ul>
  <li>How does context-aware knowledge routing improve the accuracy of responses?</li>
  <li>What other user attributes could be used for knowledge prioritization in enterprise scenarios?</li>
</ul>

<hr />

<h2 id="-use-case-5-create-a-child-it-support-agent">🔄 Use Case #5: Create a child IT Support Agent</h2>

<p>Integrate real-time incident management for comprehensive support capabilities and demonstrate agent scoping techniques.</p>

<table>
  <thead>
    <tr>
      <th>Use case</th>
      <th>Value added</th>
      <th>Estimated effort</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Add ServiceNow Incidents</td>
      <td>Integrates real-time incident management for comprehensive support capabilities with agent scoping best practices</td>
      <td>8 minutes</td>
    </tr>
  </tbody>
</table>

<p><strong>Summary of tasks</strong></p>

<p>In this section, you’ll configure the connection to ServiceNow to retrieve incident details, and learn how to scope agent capabilities for specific domains. This demonstrates how specialized tools can be integrated to create domain-specific expertise within your agent.</p>

<p><strong>Scenario:</strong> Employees need quick access to their ServiceNow incident status without navigating to the ServiceNow portal. By integrating ServiceNow directly into your agent, you’re creating a specialized IT support capability that showcases agent scoping - where specific tools and knowledge are targeted for particular use cases, improving productivity and reducing support burden.</p>

<h3 id="understanding-agent-scoping-with-servicenow-integration">Understanding Agent Scoping with ServiceNow Integration</h3>

<p>This use case demonstrates <strong>agent scoping</strong> principles:</p>
<ul>
  <li><strong>Specialized Tools</strong>: ServiceNow integration provides domain-specific capabilities</li>
  <li><strong>Contextual Routing</strong>: IT-related queries automatically leverage ServiceNow tools</li>
  <li><strong>Unified Experience</strong>: Users get comprehensive support from a single agent interface</li>
</ul>

<h3 id="step-by-step-instructions-4">Step-by-step instructions</h3>

<h4 id="create-a-child-agent">Create a child agent</h4>

<ol>
  <li>
    <p>Go to your Ask Me Anything agent</p>
  </li>
  <li>
    <p>Go to the <strong>Agents</strong> tab, and <strong>+ Add an agent</strong></p>

    <p><img src="images/add-agent.png" alt="alt text" /></p>
  </li>
  <li>
    <p>Update</p>
    <ul>
      <li>Its <strong>Name</strong> to: <code class="language-plaintext highlighter-rouge">IT Support Agent</code></li>
      <li>Its <strong>Description</strong> to:
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Use this agent for queries related to IT (e.g., knowledge base frequently asked questions, incident updates, etc.) 
The agent can multiple multiple questions and queries at once.
</code></pre></div>        </div>
      </li>
      <li>Its <strong>Instructions</strong> to:
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Use knowledge for problem/how-to/questions.
Use the Get ServiceNow ticket details tool to get the status of incidents.
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ol>

<h4 id="add-knowledge-to-the-child-agent">Add knowledge to the child agent</h4>

<ol>
  <li>
    <p>Select <strong>+ Add</strong> in the <strong>Knowledge</strong> section of the child agent</p>
  </li>
  <li>
    <p>Select <strong>ServiceNow</strong></p>
  </li>
  <li>
    <p>Choose the <strong>ServiceNow</strong> connection under <strong>Your connections</strong>, and <strong>Next</strong></p>
  </li>
  <li>
    <p>Select <strong>Knowledge</strong> as the knowledge source.</p>
  </li>
  <li>
    <p>Select <strong>Add to agent</strong></p>
  </li>
</ol>

<h4 id="add-servicenow-ticket-details-as-a-tool-to-the-child-agent">Add ServiceNow ticket details as a Tool to the child agent</h4>

<ol>
  <li>
    <p><strong>Save</strong> your child Agent</p>
  </li>
  <li>
    <p>Still within the <strong>IT Support Agent</strong>, scroll down to <strong>Tools</strong> and <strong>+ Add a tool</strong></p>
  </li>
  <li>
    <p>Search for  <code class="language-plaintext highlighter-rouge">ServiceNow List records</code></p>
  </li>
  <li>
    <p>Select <strong>Add and configure</strong></p>
  </li>
  <li>
    <p><strong>Rename</strong> to <code class="language-plaintext highlighter-rouge">Get ServiceNow ticket details</code></p>
  </li>
  <li>
    <p>Change <strong>description</strong> to <code class="language-plaintext highlighter-rouge">Gets the details of an incident using its incident number. Use this tool when users ask about ServiceNow tickets, incident status, or IT support requests.</code></p>
  </li>
</ol>

<blockquote>
  <p>[!TIP]
The description will help the AI know when to use that tool, so it’s important to have clear instructions WHEN and WHEN NOT to use this tool. This is a key aspect of agent scoping - being specific about tool usage.</p>
</blockquote>

<ol>
  <li>Under <strong>Additional details</strong>, change <strong>Credentials to use</strong> to <strong>Maker-provided credentials</strong></li>
</ol>

<blockquote>
  <p>[!IMPORTANT]
In production scenarios, you may want to use the user context when making the connection to ServiceNow. Here, your context (as the author) is used by end-users of your agent when searching for incidents.</p>
</blockquote>

<ol>
  <li>
    <p>For <strong>Record Type</strong>, under <strong>Fill using</strong>, choose <strong>Custom value</strong> and choose <code class="language-plaintext highlighter-rouge">Incident</code></p>
  </li>
  <li>
    <p>Select <strong>+ Add input</strong> and choose <strong>Query</strong></p>
  </li>
  <li>
    <p>Next to <strong>Dynamically fill with AI</strong>, select <strong>Customize</strong> and use this for <strong>Description</strong>:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The output of this variable is the concatenation of numberCONTAINS and the incident number. E.g., 'numberCONTAINSINC0007001'. Only the incident number should be prompted and obtained from the user (e.g., INC0007001)
</code></pre></div>    </div>
  </li>
</ol>

<blockquote>
  <p>[!TIP]</p>
  <ul>
    <li>Again, these instructions will be used by AI to understand how determine how to pass that information to the ServiceNow connector. In this case, how to use the very specific OData formatting of ServiceNow queries.</li>
    <li>If you get a “There is an error: ‘DuplicateItem’” error, toggle to <strong>Custom value</strong>, then switch back to <strong>Dynamically fill with AI</strong> and set the customized <strong>description</strong> again.</li>
  </ul>
</blockquote>

<ol>
  <li>
    <p>Select <strong>+ Add input</strong> and choose <strong>Limit</strong></p>
  </li>
  <li>
    <p>Under <strong>Fill using</strong>, choose <strong>Custom value</strong> and  set <strong>1</strong></p>
  </li>
  <li>
    <p>Select <strong>Save</strong></p>
  </li>
</ol>

<h4 id="test-your-it-support-agent">Test your IT Support Agent</h4>

<ol>
  <li>
    <p><strong>Test</strong> your agent:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>My USB port is no longer working on my PC... what can I do? While you're here, can you also share an update for case INC0000059? It's been quite a while since I've opened them... thanks!!
</code></pre></div>    </div>
  </li>
</ol>

<blockquote>
  <p>[!TIP]
Notice how the agent automatically:</p>
  <ul>
    <li>Asks the user to consent before running a search using ServiceNow knowledge.</li>
    <li>Uses the appropriate ServiceNow tool based on the query type</li>
    <li>Handles multiple tickets in a single request (e.g., if you ask for both cases INC0000059 and INC0000060)</li>
    <li>Creates user-friendly responses with proper formatting</li>
    <li>Combines ServiceNow data with other knowledge sources when needed</li>
  </ul>
</blockquote>

<p><img src="images/multi-agent-servicenow.png" alt="alt text" /></p>

<ol>
  <li><strong>Observe</strong> how your agent now demonstrates scoped capabilities:
    <ul>
      <li><strong>Tool Selection</strong>: Automatically chooses the right ServiceNow tool based on user intent</li>
      <li><strong>Context Preservation</strong>: Maintains conversation flow while using specialized tools</li>
      <li><strong>Domain Expertise</strong>: Provides IT-specific guidance and next steps</li>
      <li><strong>Unified Experience</strong>: Seamlessly integrates ServiceNow capabilities with other knowledge sources</li>
    </ul>
  </li>
</ol>

<blockquote>
  <p>[!IMPORTANT]
This integration showcases how agents can be scoped for specific domains while maintaining a unified user experience. The ServiceNow knowledge and tools are automatically triggered for IT-related queries, demonstrating intelligent capability routing within a single agent.</p>
</blockquote>

<hr />

<h3 id="-congratulations-youve-completed-use-case-5">🏅 Congratulations! You’ve completed Use Case #5!</h3>

<hr />

<h3 id="test-your-understanding-4">Test your understanding</h3>

<ul>
  <li>How does ServiceNow integration enhance the employee experience compared to traditional ticket lookup methods?</li>
  <li>What other enterprise systems could benefit from similar agent integration?</li>
</ul>

<hr />

<h2 id="-use-case-6-add-custom-knowledge">🔄 Use Case #6: Add Custom Knowledge</h2>

<p>Extend knowledge base with custom HTTP endpoints for enterprise system integration.</p>

<table>
  <thead>
    <tr>
      <th>Use case</th>
      <th>Value added</th>
      <th>Estimated effort</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Add Custom Knowledge</td>
      <td>Extends knowledge base with custom HTTP endpoints for enterprise system integration</td>
      <td>7 minutes</td>
    </tr>
  </tbody>
</table>

<p><strong>Summary of tasks</strong></p>

<p>In this section, you’ll configure any third-party knowledge to enrich knowledge results.</p>

<p><strong>Scenario:</strong> Your organization has custom knowledge systems or APIs that contain valuable information not available in standard connectors. You need to integrate these sources into your agent.</p>

<h3 id="step-by-step-instructions-5">Step-by-step instructions</h3>

<ol>
  <li>
    <p>Open your Ask Me Anything agent</p>
  </li>
  <li>
    <p>Go to the <strong>Topics</strong> tab, select <strong>+ Add a topic</strong> and choose <strong>From blank</strong></p>
  </li>
  <li>
    <p>Name your topic <code class="language-plaintext highlighter-rouge">Custom Knowledge</code></p>
  </li>
  <li>
    <p>In the topic command bar, select <code class="language-plaintext highlighter-rouge">...</code> and <strong>Open code editor</strong>.</p>

    <p>Replace with the below YAML code:</p>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">kind</span><span class="pi">:</span> <span class="s">AdaptiveDialog</span>
<span class="na">beginDialog</span><span class="pi">:</span>
  <span class="na">kind</span><span class="pi">:</span> <span class="s">OnKnowledgeRequested</span>
  <span class="na">id</span><span class="pi">:</span> <span class="s">main</span>

<span class="na">inputType</span><span class="pi">:</span> <span class="pi">{}</span>
<span class="na">outputType</span><span class="pi">:</span> <span class="pi">{}</span>
</code></pre></div>    </div>

    <p>Once done, select <strong>Close code editor</strong></p>
  </li>
  <li>
    <p>Add a new node &gt; <strong>Advanced</strong>, <strong>Send HTTP request</strong></p>
  </li>
  <li>
    <p>For <strong>URL</strong>, select <code class="language-plaintext highlighter-rouge">...</code>, go the <strong>Environment</strong> tab, and choose the <strong>Custom Knowledge Endpoint</strong>  variable you had created.</p>
  </li>
  <li>
    <p><strong>Method</strong>: <code class="language-plaintext highlighter-rouge">Post</code></p>
  </li>
  <li>
    <p><strong>Response data type</strong>: <code class="language-plaintext highlighter-rouge">Table</code></p>
  </li>
  <li>
    <p><strong>Edit schema</strong>:</p>

    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">kind</span><span class="pi">:</span> <span class="s">Table</span>
<span class="na">properties</span><span class="pi">:</span>
  <span class="na">Article</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">Id</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">Title</span><span class="pi">:</span> <span class="s">String</span>
  <span class="na">URL</span><span class="pi">:</span> <span class="s">String</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Edit</strong> Headers and body</p>
  </li>
  <li>
    <p>For <strong>Body</strong> toggle from <code class="language-plaintext highlighter-rouge">No content</code> to <code class="language-plaintext highlighter-rouge">JSON content</code></p>
  </li>
  <li>
    <p><strong>Toggle</strong> from <code class="language-plaintext highlighter-rouge">Edit JSON</code> to <code class="language-plaintext highlighter-rouge">Edit formula</code> and paste the below:</p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="err">SearchQuery:</span><span class="w"> </span><span class="err">System.Activity.Text</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>
    <p>Under <strong>Save response as</strong>, select <strong>Create a new variable</strong>, select the variable name that was created (e.g., <strong>Var1</strong>) and rename it <code class="language-plaintext highlighter-rouge">KnowledgeResults</code>.</p>
  </li>
</ol>

<p><img src="images/http-request.png" alt="alt text" /></p>

<ol>
  <li>
    <p>Add a new node, <strong>Variable management</strong> &gt; <strong>Set a variable value</strong></p>
  </li>
  <li>
    <p>Under <strong>Set variable</strong>, go to the <strong>System</strong> tab and choose <strong>SearchResults</strong></p>
  </li>
  <li>
    <p>Under <strong>To value</strong>, select <code class="language-plaintext highlighter-rouge">...</code>, go to the <strong>Formula</strong> tab, and paste:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ForAll(
    Topic.KnowledgeResults,
    {
        Title: Title,
        Content: Article,
        ContentLocation: URL
    }
)
</code></pre></div>    </div>
  </li>
</ol>

<blockquote>
  <p>[!TIP]
What we’re doing here with this formula is slightly transforming the content we receive from the HTTP request to the expected format that will allow to augment the search results, whenever Knowledge is invoked by the generative orchestration.</p>
</blockquote>

<ol>
  <li>
    <p><strong>Save</strong></p>
  </li>
  <li>
    <p><strong>Test</strong>:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>How do I update the vendor information for an accounts payable invoice?
</code></pre></div>    </div>
  </li>
</ol>

<blockquote>
  <p>[!TIP]
Notice how the knowledge step returned results that contain citations to a fictitious knowledge base.</p>
</blockquote>

<p><img src="images/custom-knowledge-source.png" alt="alt text" /></p>

<hr />

<h3 id="-congratulations-youve-completed-use-case-6">🏅 Congratulations! You’ve completed Use Case #6!</h3>

<hr />

<h3 id="test-your-understanding-5">Test your understanding</h3>

<ul>
  <li>How does custom knowledge integration expand the capabilities of your agent beyond standard connectors?</li>
  <li>What considerations should you have when integrating custom APIs for knowledge sources?</li>
</ul>

<hr />

<h2 id="-use-case-7-ai-summary-and-review-of-meeting-notes">🔄 Use Case #7: AI Summary and Review of Meeting Notes</h2>

<p>Automate document analysis with human review workflows for accuracy and approval.</p>

<table>
  <thead>
    <tr>
      <th>Use case</th>
      <th>Value added</th>
      <th>Estimated effort</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>AI Summary and Review of Meeting Notes</td>
      <td>Automates document analysis with human review workflows for accuracy and approval</td>
      <td>7 minutes</td>
    </tr>
  </tbody>
</table>

<p><strong>Summary of tasks</strong></p>

<p>In this section, you’ll learn how to upload files and run files through a prompt for analysis, and how to use adaptive cards to ask for human review for edits before submitting a meeting report.</p>

<p><strong>Scenario:</strong> Employees need help structuring meeting notes efficiently while maintaining human oversight for accuracy. You’ll implement AI-powered analysis with human review workflows.</p>

<h3 id="step-by-step-instructions-6">Step-by-step instructions</h3>

<ol>
  <li>
    <p>Open your Ask Me Anything agent</p>
  </li>
  <li>
    <p>Go to the <strong>Topics</strong> tab, select <strong>+ Add a topic</strong> and choose <strong>From blank</strong></p>
  </li>
  <li>
    <p>Name your topic <code class="language-plaintext highlighter-rouge">Meeting Notes</code></p>
  </li>
  <li>
    <p>Under <strong>Describe what this topic does</strong> paste:</p>
  </li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Use this tool to help users with meeting notes
</code></pre></div></div>

<ol>
  <li>
    <p>Add a <strong>Question</strong> node: <code class="language-plaintext highlighter-rouge">Sure, I can help you with that! Please upload your meeting notes</code></p>

    <p>Under <strong>Identify</strong>, select <code class="language-plaintext highlighter-rouge">File</code></p>

    <p>Rename the <strong>Save user response as</strong> variable from <strong>Var1</strong> to <code class="language-plaintext highlighter-rouge">File</code></p>
  </li>
  <li>
    <p>Add a new node, <strong>Add a tool</strong>, <strong>New prompt</strong></p>
  </li>
  <li>
    <p>Change the <strong>Name</strong> to <code class="language-plaintext highlighter-rouge">Meeting AI Notes</code></p>
  </li>
  <li>
    <p>Keep the <strong>Model</strong> as <code class="language-plaintext highlighter-rouge">GPT-4.1 mini</code> or use <code class="language-plaintext highlighter-rouge">GPT-4o</code> if not available</p>
  </li>
  <li>
    <p>Select <strong>+ Add content</strong>, and choose <strong>Image or Document</strong></p>
  </li>
</ol>

<blockquote>
  <p>[!IMPORTANT]
As a sample, use the <strong>Meeting Minutes.pdf</strong> file provided in the <strong>Lab Resources</strong> (specific per training).</p>
</blockquote>

<ol>
  <li>
    <p><strong>Rename</strong> the input to <code class="language-plaintext highlighter-rouge">UploadedNotes</code></p>
  </li>
  <li>
    <p>In the <strong>Instructions</strong>, just below <strong>UploadedNotes</strong>, paste:</p>
  </li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Using the content of the uploaded document, populate the following JSON record (for the schema, only string properties, no arrays, except for Data and time) with:
  - Title of the meeting
  - Description/summary
  - Date and time
  - List of attendees
  - Action items / next steps

  {
    "MeetingTitle": "Title of the meeting",
    "MeetingSummary": "Description/summary",
    "MeetingDateTime": "Date and time",
    "MeetingAttendees": "List of attendees",
    "MeetingActions": "Action items / next steps"
  }
</code></pre></div></div>

<ol>
  <li>
    <p>Change the <strong>Output</strong> to <code class="language-plaintext highlighter-rouge">JSON</code></p>
  </li>
  <li>
    <p><strong>Test</strong> your prompt</p>
  </li>
  <li>
    <p><strong>Save</strong> your prompt</p>

    <p><img src="images/prompt.png" alt="alt text" /></p>
  </li>
  <li>
    <p><strong>Save</strong> the topic.</p>
  </li>
  <li>
    <p>In the <strong>Prompt</strong> node, choose the <code class="language-plaintext highlighter-rouge">File</code> variable as the input for <strong>UploadedNotes</strong>.</p>
  </li>
  <li>
    <p><strong>Create</strong> a new variable for the output of the prompt node, and rename it <code class="language-plaintext highlighter-rouge">MeetingAINotes</code></p>
  </li>
  <li>
    <p>Add a new node, <strong>Ask with Adaptive Card</strong></p>
  </li>
  <li>
    <p>Go to <strong>Adaptive Card</strong> node <strong>properties</strong>.</p>
  </li>
  <li>
    <p>Select <strong>Edit adaptive card</strong>.</p>
  </li>
  <li>
    <p>In the <strong>Card payload editor</strong>, paste the below <strong>JSON</strong>:</p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AdaptiveCard"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.5"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"$schema"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://adaptivecards.io/schemas/adaptive-card.json"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"body"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TextBlock"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"text"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Please review and confirm the meeting minutes"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"weight"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bolder"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"size"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Medium"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Input.Text"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"meetingTitle"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Meeting title"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;Replace with MeetingTitle&gt;"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Input.Text"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"attendees"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Attendees"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;Replace with MeetingAttendees&gt;"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Input.Text"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"date"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Date and time"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;Replace with MeetingDateTime&gt;"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Input.Text"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"summary"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Meeting summary"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isMultiline"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;Replace with MeetingSummary&gt;"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Input.Text"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nextSteps"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Next steps"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"isMultiline"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;Replace with MeetingActions&gt;"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"actions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Action.Submit"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Confirm minutes"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>
    <p>Select <strong>Save</strong> and <strong>Close</strong>.</p>
  </li>
</ol>

<blockquote>
  <p>[!TIP]
Notice how the Adaptive Card editor offers a visual editor to create your own Adaptive Card experience with a no-code/low-code editor.</p>
</blockquote>

<ol>
  <li>
    <p>We now need to make the card dynamic to reference the content that was returned from the prompt. Toggle from <strong>JSON card</strong> to <strong>Formula card</strong>.</p>
  </li>
  <li>
    <p><strong>Expand</strong> the formula for more screen real estate.</p>
  </li>
  <li>
    <p>For each <code class="language-plaintext highlighter-rouge">"&lt;Replace with ...&gt;"</code>, <strong>replace</strong> with the matching <code class="language-plaintext highlighter-rouge">Topic.MeetingAINotes.structuredOutput.&lt;property&gt;</code> variable.</p>

    <p>Don’t forget to remove the double quotes.</p>

    <p><img src="images/adaptive-card-formula.png" alt="alt text" /></p>
  </li>
  <li>
    <p><strong>Save</strong> your topic</p>
  </li>
  <li>
    <p>Add a new <strong>Message</strong> node, and paste:</p>
  </li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Thank you! I've successfully logged your meeting notes in our systems.
</code></pre></div></div>

<ol>
  <li><strong>Test</strong> your agent. Try to modify the content directly in the adaptive card before selecting <strong>Confirm minutes</strong>.</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Please help me with my meeting notes
</code></pre></div></div>

<p><img src="images/meeting-notes-adaptive-card.png" alt="alt text" /></p>

<blockquote>
  <p>[!IMPORTANT]
Note: the lab ends here, but imagine storing these in system of records, for example Dataverse, as a next step, after the user has confirmed the content.</p>
</blockquote>

<hr />

<h3 id="-congratulations-youve-completed-use-case-7">🏅 Congratulations! You’ve completed Use Case #7!</h3>

<hr />

<h3 id="test-your-understanding-6">Test your understanding</h3>

<ul>
  <li>What are the benefits of implementing human review workflows in AI-powered document analysis?</li>
  <li>How could you extend this pattern to other document types in your organization?</li>
  <li>What next steps could you implement to store the confirmed meeting notes?</li>
</ul>

<p><strong>Challenge: Apply this to your own use case</strong></p>

<ul>
  <li>What other document types could benefit from AI-powered analysis and structuring?</li>
  <li>How could you implement approval workflows for AI-generated content in your organization?</li>
  <li>What integration points would be valuable for storing confirmed content?</li>
</ul>

<hr />

<h2 id="-summary-of-learnings">🏆 Summary of learnings</h2>

<p>True learning comes from doing, questioning, and reflecting—so let’s put your skills to the test.</p>

<p>To maximize the impact of your “Ask me anything” agent:</p>

<ul>
  <li><strong>Knowledge Integration</strong> – Connect multiple data sources to provide comprehensive answers from a single conversational interface, eliminating information silos</li>
  <li><strong>Context Awareness</strong> – Implement dynamic knowledge routing based on user attributes to ensure personalized and relevant responses</li>
  <li><strong>Seamless Deployment</strong> – Deploy to Microsoft 365 Copilot to meet employees where they already work, maximizing adoption and convenience</li>
  <li><strong>AI with Human Oversight</strong> – Combine AI-powered automation with human review processes to maintain accuracy while improving efficiency</li>
  <li><strong>Continuous Improvement</strong> – Monitor usage patterns and user feedback to iteratively enhance knowledge sources and response quality</li>
</ul>

<hr />

<h3 id="conclusions-and-recommendations">Conclusions and recommendations</h3>

<p><strong>Ask me anything agent golden rules:</strong></p>

<ul>
  <li>Start with high-value, frequently asked questions to demonstrate immediate ROI</li>
  <li>Implement proper authentication and permissions to ensure knowledge security</li>
  <li>Use suggested prompts to guide users toward the agent’s best capabilities</li>
  <li>Design context-aware experiences that reduce user input while increasing relevance</li>
  <li>Maintain human oversight for critical processes while automating routine tasks</li>
  <li>Monitor and analyze conversation patterns to identify knowledge gaps and improvement opportunities</li>
</ul>

<p>By following these principles, you’ll create an intelligent knowledge hub that transforms how employees access information, reduces support burden, and improves organizational efficiency through conversational AI.</p>

<hr />


    </div>

    <footer class="lab-footer">
        <div class="lab-navigation">
            
            
            
            
            
            
                
                
                
            
                
                
                
            
                
                
                
            
                
                
                
            
                
                
                
            
                
                
                
            
                
                
                
            
                
                    
                    
            
            
                <a href="/mcs-labs/labs/mbr-prep-sharepoint-agent/" class="nav-button prev">
                    ← MBR Agent Deploy to SharePoint
                </a>
            
            
            
                <a href="/mcs-labs/labs/autonomous-support-agent/" class="nav-button next">
                    Autonomous Support Agent →
                </a>
            
        </div>
    </footer>
</article>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2025 Microsoft Copilot Studio Labs</p>
        </div>
    </footer>
</body>
</html>